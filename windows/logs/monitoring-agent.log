[2025-09-19 03:01:36] [ERROR] Production validation failed:
[2025-09-19 03:01:36] [ERROR]   - Required directory missing: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\var
[2025-09-19 03:19:15] [ERROR] Production validation failed:
[2025-09-19 03:19:15] [ERROR]   - Required directory missing: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\var
[2025-09-19 03:20:45] [INFO] Production validation passed
[2025-09-19 03:20:46] [INFO] monitoring-agentd not running...
[2025-09-19 03:21:18] [INFO] Production validation passed
[2025-09-19 03:21:18] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 03:21:18] [DEBUG] Validating configuration...
[2025-09-19 03:21:18] [ERROR] Invalid XML structure in configuration file
[2025-09-19 03:21:18] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 03:21:18] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 03:21:18] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 03:21:18] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 03:21:18] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 03:21:18] [DEBUG] Created directory: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\var\db
[2025-09-19 03:21:18] [DEBUG] Created directory: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\queue
[2025-09-19 03:21:18] [DEBUG] Created directory: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\queue\sockets
[2025-09-19 03:21:18] [DEBUG] Created directory: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\queue\alerts
[2025-09-19 03:21:18] [DEBUG] Created directory: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\queue\diff
[2025-09-19 03:21:18] [DEBUG] Created directory: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\queue\logcollector
[2025-09-19 03:21:18] [DEBUG] Created directory: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\queue\rids
[2025-09-19 03:21:18] [DEBUG] Created directory: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\queue\fim
[2025-09-19 03:21:18] [DEBUG] Created directory: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\queue\fim\db
[2025-09-19 03:21:18] [DEBUG] Created directory: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\tmp
[2025-09-19 03:21:18] [DEBUG] Created directory: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\backup
[2025-09-19 03:21:18] [DEBUG] Created directory: C:\ProgramData\monitoring-agent\logs
[2025-09-19 03:21:18] [INFO] Environment setup completed
[2025-09-19 03:21:18] [DEBUG] Checking for disabled agent connection...
[2025-09-19 03:21:18] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 03:21:18] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 03:21:18] [ERROR] Unhandled exception: The term 'Setup-SignalHandlers' is not recognized as a name of a cmdlet, function, script file, or executable program.
Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[2025-09-19 03:21:18] [DEBUG] Stack trace:    at System.Management.Automation.ExceptionHandlingOps.CheckActionPreference(FunctionContext funcContext, Exception exception)
   at System.Management.Automation.Interpreter.ActionCallInstruction`2.Run(InterpretedFrame frame)
   at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)
   at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)
[2025-09-19 03:22:33] [INFO] Production validation passed
[2025-09-19 03:22:33] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 03:22:33] [DEBUG] Validating configuration...
[2025-09-19 03:22:33] [ERROR] Invalid XML structure in configuration file
[2025-09-19 03:22:33] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 03:22:33] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 03:22:33] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 03:22:33] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 03:22:33] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 03:22:33] [INFO] Environment setup completed
[2025-09-19 03:22:33] [DEBUG] Checking for disabled agent connection...
[2025-09-19 03:22:33] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 03:22:33] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 03:22:33] [DEBUG] Signal handlers configured for Windows
[2025-09-19 03:22:33] [DEBUG] State tracking initialized
[2025-09-19 03:22:33] [INFO] Starting monitoring-agentd...
[2025-09-19 03:22:33] [DEBUG] Starting process with bypass: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\bin\MONITORING_AGENT.EXE
[2025-09-19 03:22:33] [INFO] ✓ Started monitoring-agentd
[2025-09-19 03:22:35] [DEBUG] Completing fault tolerance startup for Windows...
[2025-09-19 03:22:35] [ERROR] Unhandled exception: The term 'Initialize-RecoverySystem' is not recognized as a name of a cmdlet, function, script file, or executable program.
Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[2025-09-19 03:22:35] [DEBUG] Stack trace:    at System.Management.Automation.ExceptionHandlingOps.CheckActionPreference(FunctionContext funcContext, Exception exception)
   at System.Management.Automation.Interpreter.ActionCallInstruction`2.Run(InterpretedFrame frame)
   at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)
   at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)
[2025-09-19 03:22:45] [INFO] Production validation passed
[2025-09-19 03:22:45] [INFO] monitoring-agentd: Process 14612 not used by Monitoring Agent, removing...
[2025-09-19 03:22:45] [INFO] monitoring-agentd not running...
[2025-09-19 03:22:54] [INFO] Production validation passed
[2025-09-19 03:22:54] [INFO] monitoring-agentd not running...
[2025-09-19 03:24:01] [INFO] Production validation passed
[2025-09-19 03:24:01] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 03:24:01] [DEBUG] Validating configuration...
[2025-09-19 03:24:01] [ERROR] Invalid XML structure in configuration file
[2025-09-19 03:24:01] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 03:24:01] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 03:24:01] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 03:24:01] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 03:24:01] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 03:24:01] [INFO] Environment setup completed
[2025-09-19 03:24:01] [DEBUG] Checking for disabled agent connection...
[2025-09-19 03:24:01] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 03:24:01] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 03:24:01] [DEBUG] Signal handlers configured for Windows
[2025-09-19 03:24:01] [DEBUG] State tracking initialized
[2025-09-19 03:24:01] [INFO] Starting monitoring-agentd...
[2025-09-19 03:24:01] [DEBUG] Starting process with bypass: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\bin\MONITORING_AGENT.EXE
[2025-09-19 03:24:01] [INFO] ✓ Started monitoring-agentd
[2025-09-19 03:24:03] [DEBUG] Completing fault tolerance startup for Windows...
[2025-09-19 03:24:03] [DEBUG] Initializing recovery system for Windows...
[2025-09-19 03:24:03] [DEBUG] Recovery system initialized
[2025-09-19 03:24:03] [INFO] ✓ Monitoring Agent started successfully with fault tolerance!
[2025-09-19 03:24:18] [INFO] Production validation passed
[2025-09-19 03:24:18] [INFO] monitoring-agentd: Process 21876 not used by Monitoring Agent, removing...
[2025-09-19 03:24:18] [INFO] monitoring-agentd not running...
[2025-09-19 03:24:43] [INFO] Production validation passed
[2025-09-19 03:24:43] [INFO] Showing last 20 lines of log file:
[2025-09-19 03:37:11] [INFO] Production validation passed
[2025-09-19 03:37:11] [INFO] Testing connection to Monitoring manager...
[2025-09-19 03:37:11] [INFO] Testing connectivity to 172.17.0.2:1514...
[2025-09-19 03:37:16] [ERROR] Network connectivity: ✗ FAILED
[2025-09-19 03:40:49] [INFO] Production validation passed
[2025-09-19 03:40:49] [INFO] Testing connection to Monitoring manager...
[2025-09-19 03:40:49] [INFO] Testing connectivity to localhost:1514...
[2025-09-19 03:40:49] [INFO] Network connectivity: ✓ SUCCESS
[2025-09-19 03:40:49] [INFO] Agent enrollment: ✓ CONFIGURED
[2025-09-19 03:40:49] [INFO] Connection test completed successfully
[2025-09-19 03:42:22] [INFO] Production validation passed
[2025-09-19 03:42:22] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 03:42:22] [DEBUG] Validating configuration...
[2025-09-19 03:42:22] [ERROR] Invalid XML structure in configuration file
[2025-09-19 03:42:22] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 03:42:22] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 03:42:22] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 03:42:22] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 03:42:22] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 03:42:22] [INFO] Environment setup completed
[2025-09-19 03:42:22] [DEBUG] Checking for disabled agent connection...
[2025-09-19 03:42:22] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 03:42:22] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 03:42:22] [DEBUG] Signal handlers configured for Windows
[2025-09-19 03:42:22] [DEBUG] State tracking initialized
[2025-09-19 03:42:22] [INFO] Starting monitoring-agentd...
[2025-09-19 03:42:22] [DEBUG] Starting process with bypass: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\bin\MONITORING_AGENT.EXE
[2025-09-19 03:42:22] [INFO] ✓ Started monitoring-agentd
[2025-09-19 03:42:24] [DEBUG] Completing fault tolerance startup for Windows...
[2025-09-19 03:42:24] [DEBUG] Initializing recovery system for Windows...
[2025-09-19 03:42:24] [DEBUG] Recovery system initialized
[2025-09-19 03:42:24] [INFO] ✓ Monitoring Agent started successfully with fault tolerance!
[2025-09-19 03:42:43] [INFO] Production validation passed
[2025-09-19 03:42:43] [INFO] monitoring-agentd: Process 14340 not used by Monitoring Agent, removing...
[2025-09-19 03:42:43] [INFO] monitoring-agentd not running...
[2025-09-19 03:42:50] [INFO] Production validation passed
[2025-09-19 03:42:50] [INFO] Showing last 10 lines of log file:
[2025-09-19 03:45:26] [INFO] Production validation passed
[2025-09-19 03:45:26] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 03:45:26] [DEBUG] Validating configuration...
[2025-09-19 03:45:26] [ERROR] Invalid XML structure in configuration file
[2025-09-19 03:45:26] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 03:45:26] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 03:45:26] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 03:45:26] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 03:45:26] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 03:45:26] [INFO] Environment setup completed
[2025-09-19 03:45:26] [DEBUG] Checking for disabled agent connection...
[2025-09-19 03:45:26] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 03:45:26] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 03:45:26] [DEBUG] Signal handlers configured for Windows
[2025-09-19 03:45:26] [DEBUG] State tracking initialized
[2025-09-19 03:45:26] [INFO] Starting monitoring-agentd...
[2025-09-19 03:45:26] [DEBUG] Starting process with bypass: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\bin\MONITORING_AGENT.EXE
[2025-09-19 03:45:26] [INFO] ✓ Started monitoring-agentd
[2025-09-19 03:45:28] [DEBUG] Completing fault tolerance startup for Windows...
[2025-09-19 03:45:28] [DEBUG] Initializing recovery system for Windows...
[2025-09-19 03:45:28] [DEBUG] Recovery system initialized
[2025-09-19 03:45:28] [INFO] ✓ Monitoring Agent started successfully with fault tolerance!
[2025-09-19 03:46:07] [INFO] Production validation passed
[2025-09-19 03:46:07] [INFO] monitoring-agentd: Process 15660 not used by Monitoring Agent, removing...
[2025-09-19 03:46:07] [INFO] monitoring-agentd not running...
[2025-09-19 03:47:43] [INFO] Production validation passed
[2025-09-19 03:47:43] [INFO] Stopping Monitoring Agent v4.8.0 and Fault Tolerance...
[2025-09-19 03:47:43] [INFO] Windows services not available on this platform
[2025-09-19 03:47:43] [INFO] Forcing agent disconnection from Wazuh manager...
[2025-09-19 03:47:43] [INFO] Agent ID: 001 - temporarily disabling connection
[2025-09-19 03:47:43] [INFO] Agent authentication disabled - will appear as disconnected
[2025-09-19 03:47:45] [DEBUG] Stopping fault tolerance components for Windows...
[2025-09-19 03:47:48] [INFO] monitoring-agentd not running...
[2025-09-19 03:47:48] [INFO] Monitoring Agent v4.8.0 Stopped
[2025-09-19 03:48:21] [INFO] Production validation passed
[2025-09-19 03:48:21] [DEBUG] Validating configuration...
[2025-09-19 03:48:21] [ERROR] Invalid XML structure in configuration file
[2025-09-19 03:48:21] [INFO] Stopping Monitoring Agent v4.8.0 and Fault Tolerance...
[2025-09-19 03:48:21] [INFO] Windows services not available on this platform
[2025-09-19 03:48:21] [INFO] Forcing agent disconnection from Wazuh manager...
[2025-09-19 03:48:21] [WARN] Client keys file not found - agent not enrolled
[2025-09-19 03:48:23] [DEBUG] Stopping fault tolerance components for Windows...
[2025-09-19 03:48:26] [INFO] monitoring-agentd not running...
[2025-09-19 03:48:26] [INFO] Monitoring Agent v4.8.0 Stopped
[2025-09-19 03:48:27] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 03:48:27] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 03:48:27] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 03:48:27] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 03:48:27] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 03:48:27] [INFO] Environment setup completed
[2025-09-19 03:48:27] [DEBUG] Checking for disabled agent connection...
[2025-09-19 03:48:27] [INFO] Agent authentication restored
[2025-09-19 03:48:27] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 03:48:27] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 03:48:27] [DEBUG] Signal handlers configured for Windows
[2025-09-19 03:48:27] [DEBUG] State tracking initialized
[2025-09-19 03:48:27] [INFO] Starting monitoring-agentd...
[2025-09-19 03:48:27] [DEBUG] Starting process with bypass: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\bin\MONITORING_AGENT.EXE
[2025-09-19 03:48:27] [INFO] ✓ Started monitoring-agentd
[2025-09-19 03:48:29] [DEBUG] Completing fault tolerance startup for Windows...
[2025-09-19 03:48:29] [DEBUG] Initializing recovery system for Windows...
[2025-09-19 03:48:29] [DEBUG] Recovery system initialized
[2025-09-19 03:48:29] [INFO] ✓ Monitoring Agent started successfully with fault tolerance!
[2025-09-19 03:50:40] [INFO] Production validation passed
[2025-09-19 03:50:40] [DEBUG] Validating configuration...
[2025-09-19 03:50:40] [ERROR] Invalid XML structure in configuration file
[2025-09-19 03:50:40] [INFO] Stopping Monitoring Agent v4.8.0 and Fault Tolerance...
[2025-09-19 03:50:40] [INFO] Windows services not available on this platform
[2025-09-19 03:50:40] [INFO] Forcing agent disconnection from Wazuh manager...
[2025-09-19 03:50:40] [INFO] Agent ID: 001 - temporarily disabling connection
[2025-09-19 03:50:40] [INFO] Agent authentication disabled - will appear as disconnected
[2025-09-19 03:50:42] [DEBUG] Stopping fault tolerance components for Windows...
[2025-09-19 03:50:45] [INFO] Deleting PID file 'C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\var\run\monitoring-agentd-19760.pid' not used...
[2025-09-19 03:50:45] [INFO] monitoring-agentd not running...
[2025-09-19 03:50:45] [INFO] Monitoring Agent v4.8.0 Stopped
[2025-09-19 03:50:46] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 03:50:46] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 03:50:46] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 03:50:46] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 03:50:46] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 03:50:46] [INFO] Environment setup completed
[2025-09-19 03:50:46] [DEBUG] Checking for disabled agent connection...
[2025-09-19 03:50:46] [INFO] Agent authentication restored
[2025-09-19 03:50:46] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 03:50:46] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 03:50:46] [DEBUG] Signal handlers configured for Windows
[2025-09-19 03:50:46] [DEBUG] State tracking initialized
[2025-09-19 03:50:46] [INFO] Starting monitoring-agentd...
[2025-09-19 03:50:46] [DEBUG] Starting process with bypass: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\bin\MONITORING_AGENT.EXE
[2025-09-19 03:50:46] [INFO] ✓ Started monitoring-agentd
[2025-09-19 03:50:48] [DEBUG] Completing fault tolerance startup for Windows...
[2025-09-19 03:50:48] [DEBUG] Initializing recovery system for Windows...
[2025-09-19 03:50:48] [DEBUG] Recovery system initialized
[2025-09-19 03:50:48] [INFO] ✓ Monitoring Agent started successfully with fault tolerance!
[2025-09-19 03:51:48] [INFO] Production validation passed
[2025-09-19 03:51:48] [INFO] monitoring-agentd: Process 22916 not used by Monitoring Agent, removing...
[2025-09-19 03:51:48] [INFO] monitoring-agentd not running...
[2025-09-19 03:52:16] [INFO] Production validation passed
[2025-09-19 03:52:16] [INFO] Stopping Monitoring Agent v4.8.0 and Fault Tolerance...
[2025-09-19 03:52:16] [INFO] Windows services not available on this platform
[2025-09-19 03:52:16] [INFO] Forcing agent disconnection from Wazuh manager...
[2025-09-19 03:52:16] [INFO] Agent ID: 001 - temporarily disabling connection
[2025-09-19 03:52:16] [INFO] Agent authentication disabled - will appear as disconnected
[2025-09-19 03:52:18] [DEBUG] Stopping fault tolerance components for Windows...
[2025-09-19 03:52:21] [INFO] monitoring-agentd not running...
[2025-09-19 03:52:22] [INFO] Monitoring Agent v4.8.0 Stopped
[2025-09-19 04:09:05] [INFO] Production validation passed
[2025-09-19 04:09:05] [INFO] Stopping Monitoring Agent v4.8.0 and Fault Tolerance...
[2025-09-19 04:09:05] [INFO] Windows services not available on this platform
[2025-09-19 04:09:05] [INFO] Forcing agent disconnection from Wazuh manager...
[2025-09-19 04:09:05] [WARN] Client keys file not found - agent not enrolled
[2025-09-19 04:09:07] [DEBUG] Stopping fault tolerance components for Windows...
[2025-09-19 04:09:11] [INFO] monitoring-agentd not running...
[2025-09-19 04:09:11] [INFO] Monitoring Agent v4.8.0 Stopped
[2025-09-19 04:09:18] [INFO] Production validation passed
[2025-09-19 04:09:18] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 04:09:18] [DEBUG] Validating configuration...
[2025-09-19 04:09:18] [ERROR] Invalid XML structure in configuration file
[2025-09-19 04:09:18] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 04:09:18] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 04:09:18] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 04:09:18] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 04:09:18] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 04:09:18] [INFO] Environment setup completed
[2025-09-19 04:09:18] [DEBUG] Checking for disabled agent connection...
[2025-09-19 04:09:18] [INFO] Agent authentication restored
[2025-09-19 04:09:18] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 04:09:18] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 04:09:18] [DEBUG] Signal handlers configured for Windows
[2025-09-19 04:09:18] [DEBUG] State tracking initialized
[2025-09-19 04:09:18] [INFO] Starting monitoring-agentd...
[2025-09-19 04:09:18] [DEBUG] Starting process with bypass: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\bin\MONITORING_AGENT.EXE
[2025-09-19 04:09:18] [DEBUG] Bypass DLL environment set: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 04:09:18] [INFO] ✓ Started monitoring-agentd with PID: 20960
[2025-09-19 04:09:21] [ERROR] Monitoring Agent process exited immediately (Exit Code: -1066598274)
[2025-09-19 04:12:17] [INFO] Production validation passed
[2025-09-19 04:12:22] [INFO] Production validation passed
[2025-09-19 04:12:22] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 04:12:22] [DEBUG] Validating configuration...
[2025-09-19 04:12:22] [ERROR] Invalid XML structure in configuration file
[2025-09-19 04:12:22] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 04:12:22] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 04:12:22] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 04:12:22] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 04:12:22] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 04:12:22] [INFO] Environment setup completed
[2025-09-19 04:12:22] [DEBUG] Checking for disabled agent connection...
[2025-09-19 04:12:22] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 04:12:22] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 04:12:22] [DEBUG] Signal handlers configured for Windows
[2025-09-19 04:12:22] [DEBUG] State tracking initialized
[2025-09-19 04:12:22] [INFO] Starting monitoring-agentd...
[2025-09-19 04:12:22] [DEBUG] Starting process with bypass: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\bin\MONITORING_AGENT.EXE
[2025-09-19 04:12:22] [DEBUG] Bypass DLL environment set: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 04:12:22] [INFO] ✓ Started monitoring-agentd with PID: 20984
[2025-09-19 04:12:25] [INFO] ✓ Monitoring Agent started successfully!
[2025-09-19 04:12:26] [DEBUG] Completing fault tolerance startup for Windows...
[2025-09-19 04:12:26] [DEBUG] Initializing recovery system for Windows...
[2025-09-19 04:12:26] [DEBUG] Recovery system initialized
[2025-09-19 04:12:26] [INFO] ✓ Monitoring Agent started successfully with fault tolerance!
[2025-09-19 04:12:44] [INFO] Production validation passed
[2025-09-19 04:12:44] [INFO] Showing last 20 lines of log file:
[2025-09-19 04:20:38] [INFO] Production validation passed
[2025-09-19 04:20:38] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 04:20:38] [DEBUG] Validating configuration...
[2025-09-19 04:20:38] [ERROR] Invalid XML structure in configuration file
[2025-09-19 04:20:38] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 04:20:38] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 04:20:38] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 04:20:38] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 04:20:38] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 04:20:38] [INFO] Environment setup completed
[2025-09-19 04:20:38] [DEBUG] Checking for disabled agent connection...
[2025-09-19 04:20:38] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 04:20:38] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 04:20:38] [DEBUG] Signal handlers configured for Windows
[2025-09-19 04:20:38] [DEBUG] State tracking initialized
[2025-09-19 04:20:38] [INFO] Starting monitoring-agentd...
[2025-09-19 04:20:38] [DEBUG] Starting process with bypass: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\bin\MONITORING_AGENT.EXE
[2025-09-19 04:20:38] [DEBUG] Bypass DLL environment set: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 04:20:38] [INFO] ✓ Started monitoring-agentd with PID: 19824
[2025-09-19 04:20:41] [INFO] ✓ Monitoring Agent started successfully!
[2025-09-19 04:20:41] [DEBUG] Completing fault tolerance startup for Windows...
[2025-09-19 04:20:41] [DEBUG] Initializing recovery system for Windows...
[2025-09-19 04:20:41] [DEBUG] Recovery system initialized
[2025-09-19 04:20:41] [INFO] ✓ Monitoring Agent started successfully with fault tolerance!
[2025-09-19 04:22:34] [INFO] Production validation passed
[2025-09-19 04:22:34] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 04:22:34] [DEBUG] Validating configuration...
[2025-09-19 04:22:34] [ERROR] Invalid XML structure in configuration file
[2025-09-19 04:22:34] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 04:22:34] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 04:22:34] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 04:22:34] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 04:22:34] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 04:22:35] [INFO] Environment setup completed
[2025-09-19 04:22:35] [DEBUG] Checking for disabled agent connection...
[2025-09-19 04:22:35] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 04:22:35] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 04:22:35] [DEBUG] Signal handlers configured for Windows
[2025-09-19 04:22:35] [DEBUG] State tracking initialized
[2025-09-19 04:22:35] [INFO] Starting monitoring-agentd...
[2025-09-19 04:22:35] [DEBUG] Starting Windows service approach...
[2025-09-19 04:22:35] [INFO] Starting Wazuh service...
[2025-09-19 04:22:35] [INFO] ✓ Wazuh service started successfully!
[2025-09-19 04:23:45] [INFO] Production validation passed
[2025-09-19 04:23:45] [INFO] monitoring-agentd not running...
[2025-09-19 04:39:47] [INFO] Production validation passed
[2025-09-19 04:39:47] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 04:39:47] [DEBUG] Validating configuration...
[2025-09-19 04:39:47] [ERROR] Invalid XML structure in configuration file
[2025-09-19 04:39:47] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 04:39:47] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 04:39:47] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 04:39:47] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 04:39:47] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 04:39:47] [INFO] Environment setup completed
[2025-09-19 04:39:47] [DEBUG] Checking for disabled agent connection...
[2025-09-19 04:39:47] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 04:39:47] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 04:39:47] [DEBUG] Signal handlers configured for Windows
[2025-09-19 04:39:47] [DEBUG] State tracking initialized
[2025-09-19 04:39:47] [INFO] Starting monitoring-agentd...
[2025-09-19 04:39:47] [DEBUG] Setting up Windows agent environment...
[2025-09-19 04:39:47] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 04:39:47] [DEBUG] Copied client.keys to bin directory
[2025-09-19 04:39:47] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 04:39:47] [DEBUG] Copied local_internal_options.conf to bin directory
[2025-09-19 04:39:47] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 04:39:47] [DEBUG] Copied bypass.dll to bin directory
[2025-09-19 04:39:47] [DEBUG] Copied dbsync.dll to bin directory
[2025-09-19 04:39:47] [DEBUG] Copied fimdb.dll to bin directory
[2025-09-19 04:39:47] [DEBUG] Copied LIBGCC_S_DW2_1.DLL to bin directory
[2025-09-19 04:39:47] [DEBUG] Copied LIBSTDCPP_6.DLL to bin directory
[2025-09-19 04:39:47] [DEBUG] Copied libwazuhext.dll to bin directory
[2025-09-19 04:39:47] [DEBUG] Copied libwazuhshared.dll to bin directory
[2025-09-19 04:39:47] [DEBUG] Copied LIBWINPTHREAD_1.DLL to bin directory
[2025-09-19 04:39:47] [DEBUG] Copied rsync.dll to bin directory
[2025-09-19 04:39:47] [DEBUG] Copied syscollector.dll to bin directory
[2025-09-19 04:39:47] [DEBUG] Copied sysinfo.dll to bin directory
[2025-09-19 04:39:47] [DEBUG] Starting Windows service approach...
[2025-09-19 04:39:47] [INFO] Starting Wazuh service...
[2025-09-19 04:39:50] [WARN] Service attempt 1/5 - Status: StopPending
[2025-09-19 04:39:50] [INFO] Retrying service start...
[2025-09-19 04:39:55] [WARN] Service attempt 2/5 - Status: StopPending
[2025-09-19 04:39:55] [INFO] Retrying service start...
[2025-09-19 04:40:32] [INFO] Production validation passed
[2025-09-19 04:40:32] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 04:40:32] [DEBUG] Validating configuration...
[2025-09-19 04:40:32] [ERROR] Invalid XML structure in configuration file
[2025-09-19 04:40:32] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 04:40:32] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 04:40:32] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 04:40:32] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 04:40:32] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 04:40:32] [INFO] Environment setup completed
[2025-09-19 04:40:32] [DEBUG] Checking for disabled agent connection...
[2025-09-19 04:40:32] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 04:40:32] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 04:40:32] [DEBUG] Signal handlers configured for Windows
[2025-09-19 04:40:32] [DEBUG] State tracking initialized
[2025-09-19 04:40:32] [INFO] Starting monitoring-agentd...
[2025-09-19 04:40:32] [DEBUG] Setting up Windows agent environment...
[2025-09-19 04:40:32] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 04:40:32] [DEBUG] Copied client.keys to bin directory
[2025-09-19 04:40:32] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 04:40:32] [DEBUG] Copied local_internal_options.conf to bin directory
[2025-09-19 04:40:32] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 04:40:32] [DEBUG] Copied bypass.dll to bin directory
[2025-09-19 04:40:32] [DEBUG] Copied dbsync.dll to bin directory
[2025-09-19 04:40:32] [DEBUG] Copied fimdb.dll to bin directory
[2025-09-19 04:40:32] [DEBUG] Copied LIBGCC_S_DW2_1.DLL to bin directory
[2025-09-19 04:40:32] [DEBUG] Copied LIBSTDCPP_6.DLL to bin directory
[2025-09-19 04:40:32] [DEBUG] Copied libwazuhext.dll to bin directory
[2025-09-19 04:40:32] [DEBUG] Copied libwazuhshared.dll to bin directory
[2025-09-19 04:40:32] [DEBUG] Copied LIBWINPTHREAD_1.DLL to bin directory
[2025-09-19 04:40:32] [DEBUG] Copied rsync.dll to bin directory
[2025-09-19 04:40:32] [DEBUG] Copied syscollector.dll to bin directory
[2025-09-19 04:40:32] [DEBUG] Copied sysinfo.dll to bin directory
[2025-09-19 04:40:32] [DEBUG] Starting Windows service approach...
[2025-09-19 04:40:32] [INFO] Starting Wazuh service...
[2025-09-19 04:40:35] [WARN] Service attempt 1/5 - Status: StopPending
[2025-09-19 04:40:35] [INFO] Retrying service start...
[2025-09-19 04:40:40] [WARN] Service attempt 2/5 - Status: StopPending
[2025-09-19 04:40:40] [INFO] Retrying service start...
[2025-09-19 04:40:45] [WARN] Service attempt 3/5 - Status: Stopped
[2025-09-19 04:40:45] [INFO] Retrying service start...
[2025-09-19 04:40:48] [WARN] Service attempt 4/5 - Status: StopPending
[2025-09-19 04:40:48] [INFO] Retrying service start...
[2025-09-19 04:40:53] [WARN] Service attempt 5/5 - Status: StopPending
[2025-09-19 04:40:53] [ERROR] Failed to start Wazuh service after 5 attempts
[2025-09-19 04:40:53] [INFO] Attempting alternative process start method...
[2025-09-19 04:52:16] [INFO] Production validation passed
[2025-09-19 04:52:16] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 04:52:16] [DEBUG] Validating configuration...
[2025-09-19 04:52:16] [ERROR] Invalid XML structure in configuration file
[2025-09-19 04:52:16] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 04:52:16] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 04:52:16] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 04:52:16] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 04:52:16] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 04:52:16] [INFO] Environment setup completed
[2025-09-19 04:52:16] [DEBUG] Checking for disabled agent connection...
[2025-09-19 04:52:16] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 04:52:16] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 04:52:16] [DEBUG] Signal handlers configured for Windows
[2025-09-19 04:52:16] [DEBUG] State tracking initialized
[2025-09-19 04:52:16] [INFO] Starting monitoring-agentd...
[2025-09-19 04:52:16] [DEBUG] Setting up Windows agent environment...
[2025-09-19 04:52:16] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 04:52:16] [DEBUG] Copied client.keys to bin directory
[2025-09-19 04:52:16] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 04:52:16] [DEBUG] Copied local_internal_options.conf to bin directory
[2025-09-19 04:52:16] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 04:52:16] [DEBUG] Copied bypass.dll to bin directory
[2025-09-19 04:52:16] [DEBUG] Copied dbsync.dll to bin directory
[2025-09-19 04:52:16] [DEBUG] Copied fimdb.dll to bin directory
[2025-09-19 04:52:16] [DEBUG] Copied LIBGCC_S_DW2_1.DLL to bin directory
[2025-09-19 04:52:16] [DEBUG] Copied LIBSTDCPP_6.DLL to bin directory
[2025-09-19 04:52:16] [DEBUG] Copied libwazuhext.dll to bin directory
[2025-09-19 04:52:16] [DEBUG] Copied libwazuhshared.dll to bin directory
[2025-09-19 04:52:16] [DEBUG] Copied LIBWINPTHREAD_1.DLL to bin directory
[2025-09-19 04:52:16] [DEBUG] Copied rsync.dll to bin directory
[2025-09-19 04:52:16] [DEBUG] Copied syscollector.dll to bin directory
[2025-09-19 04:52:16] [DEBUG] Copied sysinfo.dll to bin directory
[2025-09-19 04:52:16] [DEBUG] Created directory: queue\diff
[2025-09-19 04:52:16] [DEBUG] Created directory: queue\fim
[2025-09-19 04:52:16] [DEBUG] Created directory: queue\agent-upgrade
[2025-09-19 04:52:16] [INFO] Starting Wazuh agent as process...
[2025-09-19 04:52:19] [WARN] Process started but exited immediately
[2025-09-19 04:52:19] [INFO] Trying service method as fallback...
[2025-09-19 04:52:19] [INFO] Starting Wazuh service...
[2025-09-19 04:52:22] [WARN] Service attempt 1/5 - Status: StopPending
[2025-09-19 04:52:22] [INFO] Retrying service start...
[2025-09-19 04:52:27] [WARN] Service attempt 2/5 - Status: Stopped
[2025-09-19 04:52:27] [INFO] Retrying service start...
[2025-09-19 04:52:30] [WARN] Service attempt 3/5 - Status: StopPending
[2025-09-19 04:52:30] [INFO] Retrying service start...
[2025-09-19 04:52:35] [WARN] Service attempt 4/5 - Status: Stopped
[2025-09-19 04:52:35] [INFO] Retrying service start...
[2025-09-19 04:52:38] [WARN] Service attempt 5/5 - Status: StopPending
[2025-09-19 04:52:38] [ERROR] Failed to start Wazuh service after 5 attempts
[2025-09-19 04:52:38] [INFO] Attempting alternative process start method...
[2025-09-19 04:52:42] [INFO] ✓ Started agent as process with PID: 22048
[2025-09-19 04:53:07] [INFO] Production validation passed
[2025-09-19 04:53:07] [INFO] monitoring-agentd not running...
[2025-09-19 05:01:29] [INFO] Production validation passed
[2025-09-19 05:01:41] [INFO] Production validation passed
[2025-09-19 05:01:41] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 05:01:41] [DEBUG] Validating configuration...
[2025-09-19 05:01:41] [ERROR] Invalid XML structure in configuration file
[2025-09-19 05:01:41] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 05:01:41] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 05:01:41] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 05:01:41] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 05:01:41] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 05:01:41] [INFO] Environment setup completed
[2025-09-19 05:01:41] [DEBUG] Checking for disabled agent connection...
[2025-09-19 05:01:41] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 05:01:41] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 05:01:41] [DEBUG] Signal handlers configured for Windows
[2025-09-19 05:01:41] [DEBUG] State tracking initialized
[2025-09-19 05:01:41] [INFO] Starting monitoring-agentd...
[2025-09-19 05:01:41] [DEBUG] Setting up Windows agent environment...
[2025-09-19 05:01:41] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 05:01:41] [DEBUG] Copied client.keys to bin directory
[2025-09-19 05:01:41] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 05:01:41] [DEBUG] Copied local_internal_options.conf to bin directory
[2025-09-19 05:01:41] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 05:01:41] [DEBUG] Copied bypass.dll to bin directory
[2025-09-19 05:01:41] [DEBUG] Copied dbsync.dll to bin directory
[2025-09-19 05:01:41] [DEBUG] Copied fimdb.dll to bin directory
[2025-09-19 05:01:41] [DEBUG] Copied LIBGCC_S_DW2_1.DLL to bin directory
[2025-09-19 05:01:41] [DEBUG] Copied LIBSTDCPP_6.DLL to bin directory
[2025-09-19 05:01:41] [DEBUG] Copied libwazuhext.dll to bin directory
[2025-09-19 05:01:41] [DEBUG] Copied libwazuhshared.dll to bin directory
[2025-09-19 05:01:41] [DEBUG] Copied LIBWINPTHREAD_1.DLL to bin directory
[2025-09-19 05:01:41] [DEBUG] Copied rsync.dll to bin directory
[2025-09-19 05:01:41] [DEBUG] Copied syscollector.dll to bin directory
[2025-09-19 05:01:41] [DEBUG] Copied sysinfo.dll to bin directory
[2025-09-19 05:01:41] [INFO] Starting Monitoring Agent as process...
[2025-09-19 05:01:44] [WARN] Process started but exited immediately
[2025-09-19 05:01:44] [INFO] Trying service method as fallback...
[2025-09-19 05:01:44] [INFO] Starting Monitoring Agent service...
[2025-09-19 05:01:47] [WARN] Service attempt 1/5 - Status: StopPending
[2025-09-19 05:01:47] [INFO] Retrying service start...
[2025-09-19 05:01:52] [WARN] Service attempt 2/5 - Status: StopPending
[2025-09-19 05:01:52] [INFO] Retrying service start...
[2025-09-19 05:01:57] [WARN] Service attempt 3/5 - Status: Stopped
[2025-09-19 05:01:57] [INFO] Retrying service start...
[2025-09-19 05:02:00] [WARN] Service attempt 4/5 - Status: StopPending
[2025-09-19 05:02:01] [INFO] Retrying service start...
[2025-09-19 05:02:06] [WARN] Service attempt 5/5 - Status: StopPending
[2025-09-19 05:02:06] [ERROR] Failed to start Monitoring Agent service after 5 attempts
[2025-09-19 05:02:06] [INFO] Attempting alternative process start method...
[2025-09-19 05:03:10] [INFO] Production validation passed
[2025-09-19 05:03:10] [ERROR] Manager IP address required for enrollment
[2025-09-19 05:03:17] [INFO] Production validation passed
[2025-09-19 05:03:17] [INFO] Stopping Monitoring Agent v4.8.0 and Fault Tolerance...
[2025-09-19 05:03:17] [INFO] Windows services not available on this platform
[2025-09-19 05:03:17] [INFO] Forcing agent disconnection from Wazuh manager...
[2025-09-19 05:03:17] [INFO] Agent ID: 001 - temporarily disabling connection
[2025-09-19 05:03:17] [INFO] Agent authentication disabled - will appear as disconnected
[2025-09-19 05:03:19] [DEBUG] Stopping fault tolerance components for Windows...
[2025-09-19 05:03:22] [INFO] MONITORING_AGENT not running...
[2025-09-19 05:03:23] [INFO] monitoring-agentd not running...
[2025-09-19 05:03:23] [INFO] Monitoring Agent v4.8.0 Stopped
[2025-09-19 05:04:04] [INFO] Production validation passed
[2025-09-19 05:04:04] [INFO] Production validation passed
[2025-09-19 05:04:04] [INFO] Stopping Monitoring Agent v4.8.0 and Fault Tolerance...
[2025-09-19 05:04:04] [INFO] Windows services not available on this platform
[2025-09-19 05:04:04] [INFO] Forcing agent disconnection from Wazuh manager...
[2025-09-19 05:04:04] [WARN] Client keys file not found - agent not enrolled
[2025-09-19 05:04:06] [DEBUG] Stopping fault tolerance components for Windows...
[2025-09-19 05:04:09] [INFO] MONITORING_AGENT not running...
[2025-09-19 05:04:09] [INFO] monitoring-agentd not running...
[2025-09-19 05:04:09] [INFO] Monitoring Agent v4.8.0 Stopped
[2025-09-19 05:04:10] [INFO] Production validation passed
[2025-09-19 05:04:10] [INFO] Testing Windows agent configuration...
[2025-09-19 05:04:10] [DEBUG] Validating configuration...
[2025-09-19 05:04:10] [ERROR] Invalid XML structure in configuration file
[2025-09-19 05:04:10] [INFO] Configuration test completed successfully
[2025-09-19 05:04:47] [INFO] Production validation passed
[2025-09-19 05:14:21] [INFO] Production validation passed
[2025-09-19 05:14:29] [INFO] Production validation passed
[2025-09-19 05:14:29] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 05:14:29] [DEBUG] Validating configuration...
[2025-09-19 05:14:29] [ERROR] Invalid XML structure in configuration file
[2025-09-19 05:14:29] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 05:14:29] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 05:14:29] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 05:14:29] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 05:14:29] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 05:14:29] [INFO] Environment setup completed
[2025-09-19 05:14:29] [DEBUG] Checking for disabled agent connection...
[2025-09-19 05:14:29] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 05:14:29] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 05:14:29] [DEBUG] Signal handlers configured for Windows
[2025-09-19 05:14:29] [DEBUG] State tracking initialized
[2025-09-19 05:14:29] [INFO] Starting monitoring-agentd...
[2025-09-19 05:14:29] [DEBUG] Setting up Windows agent environment...
[2025-09-19 05:14:29] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 05:14:29] [DEBUG] Copied client.keys to bin directory
[2025-09-19 05:14:29] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 05:14:29] [DEBUG] Copied local_internal_options.conf to bin directory
[2025-09-19 05:14:29] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 05:14:29] [DEBUG] Copied bypass.dll to bin directory
[2025-09-19 05:14:29] [DEBUG] Copied dbsync.dll to bin directory
[2025-09-19 05:14:29] [DEBUG] Copied fimdb.dll to bin directory
[2025-09-19 05:14:29] [DEBUG] Copied LIBGCC_S_DW2_1.DLL to bin directory
[2025-09-19 05:14:29] [DEBUG] Copied LIBSTDCPP_6.DLL to bin directory
[2025-09-19 05:14:29] [DEBUG] Copied libwazuhext.dll to bin directory
[2025-09-19 05:14:29] [DEBUG] Copied libwazuhshared.dll to bin directory
[2025-09-19 05:14:29] [DEBUG] Copied LIBWINPTHREAD_1.DLL to bin directory
[2025-09-19 05:14:29] [DEBUG] Copied rsync.dll to bin directory
[2025-09-19 05:14:29] [DEBUG] Copied syscollector.dll to bin directory
[2025-09-19 05:14:29] [DEBUG] Copied sysinfo.dll to bin directory
[2025-09-19 05:14:29] [INFO] Starting Monitoring Agent as process...
[2025-09-19 05:14:32] [WARN] Process started but exited immediately
[2025-09-19 05:14:32] [DEBUG] Recent log entries: [2025-09-19 05:14:29] [DEBUG] Copied rsync.dll to bin directory; [2025-09-19 05:14:29] [DEBUG] Copied syscollector.dll to bin directory; [2025-09-19 05:14:29] [DEBUG] Copied sysinfo.dll to bin directory; [2025-09-19 05:14:29] [INFO] Starting Monitoring Agent as process...; [2025-09-19 05:14:32] [WARN] Process started but exited immediately
[2025-09-19 05:14:32] [INFO] Trying service method as fallback...
[2025-09-19 05:14:32] [INFO] Starting Monitoring Agent service...
[2025-09-19 05:14:35] [WARN] Service attempt 1/5 - Status: StopPending
[2025-09-19 05:14:35] [INFO] Retrying service start...
[2025-09-19 05:14:40] [WARN] Service attempt 2/5 - Status: Stopped
[2025-09-19 05:14:40] [INFO] Retrying service start...
[2025-09-19 05:14:43] [WARN] Service attempt 3/5 - Status: StopPending
[2025-09-19 05:14:43] [INFO] Retrying service start...
[2025-09-19 05:14:48] [WARN] Service attempt 4/5 - Status: Stopped
[2025-09-19 05:14:48] [INFO] Retrying service start...
[2025-09-19 05:14:51] [WARN] Service attempt 5/5 - Status: StopPending
[2025-09-19 05:14:51] [ERROR] Failed to start Monitoring Agent service after 5 attempts
[2025-09-19 05:14:51] [INFO] Attempting alternative process start method...
[2025-09-19 05:14:54] [INFO] ✓ Started agent as process with PID: 22552
[2025-09-19 05:15:48] [INFO] Production validation passed
[2025-09-19 05:21:59] [INFO] Production validation passed
[2025-09-19 05:22:05] [INFO] Production validation passed
[2025-09-19 05:22:05] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 05:22:05] [DEBUG] Validating configuration...
[2025-09-19 05:22:05] [DEBUG] Configuration validation passed
[2025-09-19 05:22:05] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 05:22:05] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 05:22:05] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 05:22:05] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 05:22:05] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 05:22:05] [INFO] Environment setup completed
[2025-09-19 05:22:05] [DEBUG] Checking for disabled agent connection...
[2025-09-19 05:22:05] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 05:22:05] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 05:22:05] [DEBUG] Signal handlers configured for Windows
[2025-09-19 05:22:05] [DEBUG] State tracking initialized
[2025-09-19 05:22:05] [INFO] Starting monitoring-agentd...
[2025-09-19 05:22:05] [DEBUG] Setting up Windows agent environment...
[2025-09-19 05:22:05] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 05:22:05] [DEBUG] Copied client.keys to bin directory
[2025-09-19 05:22:05] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 05:22:05] [DEBUG] Copied local_internal_options.conf to bin directory
[2025-09-19 05:22:05] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 05:22:05] [DEBUG] Copied bypass.dll to bin directory
[2025-09-19 05:22:05] [DEBUG] Copied dbsync.dll to bin directory
[2025-09-19 05:22:05] [DEBUG] Copied fimdb.dll to bin directory
[2025-09-19 05:22:05] [DEBUG] Copied LIBGCC_S_DW2_1.DLL to bin directory
[2025-09-19 05:22:05] [DEBUG] Copied LIBSTDCPP_6.DLL to bin directory
[2025-09-19 05:22:05] [DEBUG] Copied libwazuhext.dll to bin directory
[2025-09-19 05:22:05] [DEBUG] Copied libwazuhshared.dll to bin directory
[2025-09-19 05:22:05] [DEBUG] Copied LIBWINPTHREAD_1.DLL to bin directory
[2025-09-19 05:22:05] [DEBUG] Copied rsync.dll to bin directory
[2025-09-19 05:22:05] [DEBUG] Copied syscollector.dll to bin directory
[2025-09-19 05:22:05] [DEBUG] Copied sysinfo.dll to bin directory
[2025-09-19 05:22:05] [INFO] Starting Monitoring Agent as process...
[2025-09-19 05:22:08] [WARN] Process started but exited immediately
[2025-09-19 05:22:09] [DEBUG] Recent log entries: [2025-09-19 05:22:05] [DEBUG] Copied rsync.dll to bin directory; [2025-09-19 05:22:05] [DEBUG] Copied syscollector.dll to bin directory; [2025-09-19 05:22:05] [DEBUG] Copied sysinfo.dll to bin directory; [2025-09-19 05:22:05] [INFO] Starting Monitoring Agent as process...; [2025-09-19 05:22:08] [WARN] Process started but exited immediately
[2025-09-19 05:22:09] [INFO] Trying service method as fallback...
[2025-09-19 05:22:09] [INFO] Starting Monitoring Agent service...
[2025-09-19 05:22:12] [WARN] Service attempt 1/5 - Status: StopPending
[2025-09-19 05:22:12] [INFO] Retrying service start...
[2025-09-19 05:22:17] [WARN] Service attempt 2/5 - Status: StopPending
[2025-09-19 05:22:17] [INFO] Retrying service start...
[2025-09-19 05:22:22] [WARN] Service attempt 3/5 - Status: Stopped
[2025-09-19 05:22:22] [INFO] Retrying service start...
[2025-09-19 05:22:25] [WARN] Service attempt 4/5 - Status: StopPending
[2025-09-19 05:22:25] [INFO] Retrying service start...
[2025-09-19 05:22:30] [WARN] Service attempt 5/5 - Status: Stopped
[2025-09-19 05:22:30] [ERROR] Failed to start Monitoring Agent service after 5 attempts
[2025-09-19 05:22:30] [INFO] Attempting alternative process start method...
[2025-09-19 05:26:05] [INFO] Production validation passed
[2025-09-19 05:26:05] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 05:26:05] [DEBUG] Validating configuration...
[2025-09-19 05:26:05] [DEBUG] Configuration validation passed
[2025-09-19 05:26:05] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 05:26:05] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 05:26:05] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 05:26:05] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 05:26:05] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 05:26:05] [INFO] Environment setup completed
[2025-09-19 05:26:05] [DEBUG] Checking for disabled agent connection...
[2025-09-19 05:26:05] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 05:26:05] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 05:26:05] [DEBUG] Signal handlers configured for Windows
[2025-09-19 05:26:05] [DEBUG] State tracking initialized
[2025-09-19 05:26:05] [INFO] Starting monitoring-agentd...
[2025-09-19 05:26:05] [DEBUG] Setting up Windows agent environment...
[2025-09-19 05:26:05] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 05:26:05] [DEBUG] Copied client.keys to bin directory
[2025-09-19 05:26:05] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 05:26:05] [DEBUG] Copied local_internal_options.conf to bin directory
[2025-09-19 05:26:05] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 05:26:05] [DEBUG] Copied bypass.dll to bin directory
[2025-09-19 05:26:05] [DEBUG] Copied dbsync.dll to bin directory
[2025-09-19 05:26:05] [DEBUG] Copied fimdb.dll to bin directory
[2025-09-19 05:26:05] [DEBUG] Copied LIBGCC_S_DW2_1.DLL to bin directory
[2025-09-19 05:26:05] [DEBUG] Copied LIBSTDCPP_6.DLL to bin directory
[2025-09-19 05:26:06] [DEBUG] Copied libwazuhext.dll to bin directory
[2025-09-19 05:26:06] [DEBUG] Copied libwazuhshared.dll to bin directory
[2025-09-19 05:26:06] [DEBUG] Copied LIBWINPTHREAD_1.DLL to bin directory
[2025-09-19 05:26:06] [DEBUG] Copied rsync.dll to bin directory
[2025-09-19 05:26:06] [DEBUG] Copied syscollector.dll to bin directory
[2025-09-19 05:26:06] [DEBUG] Copied sysinfo.dll to bin directory
[2025-09-19 05:26:06] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 05:26:06] [DEBUG] Copied client.keys to bin directory
[2025-09-19 05:26:06] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 05:26:06] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 05:26:06] [INFO] Starting Monitoring Agent as process...
[2025-09-19 05:26:09] [WARN] Process started but exited immediately
[2025-09-19 05:26:09] [DEBUG] Recent log entries: [2025-09-19 05:26:06] [DEBUG] Copied client.keys to bin directory; [2025-09-19 05:26:06] [DEBUG] Copied internal_options.conf to bin directory; [2025-09-19 05:26:06] [DEBUG] Copied wpk_root.pem to bin directory; [2025-09-19 05:26:06] [INFO] Starting Monitoring Agent as process...; [2025-09-19 05:26:09] [WARN] Process started but exited immediately
[2025-09-19 05:26:09] [INFO] Trying service method as fallback...
[2025-09-19 05:26:09] [INFO] Starting Monitoring Agent service...
[2025-09-19 05:26:12] [WARN] Service attempt 1/5 - Status: StopPending
[2025-09-19 05:26:12] [INFO] Retrying service start...
[2025-09-19 05:26:17] [WARN] Service attempt 2/5 - Status: StopPending
[2025-09-19 05:26:17] [INFO] Retrying service start...
[2025-09-19 05:26:22] [WARN] Service attempt 3/5 - Status: Stopped
[2025-09-19 05:26:22] [INFO] Retrying service start...
[2025-09-19 05:26:25] [WARN] Service attempt 4/5 - Status: StopPending
[2025-09-19 05:26:25] [INFO] Retrying service start...
[2025-09-19 05:26:30] [WARN] Service attempt 5/5 - Status: StopPending
[2025-09-19 05:26:30] [ERROR] Failed to start Monitoring Agent service after 5 attempts
[2025-09-19 05:26:30] [INFO] Attempting alternative process start method...
[2025-09-19 05:26:34] [INFO] ✓ Started agent as process with PID: 18924
[2025-09-19 05:26:44] [INFO] Production validation passed
[2025-09-19 05:29:06] [INFO] Production validation passed
[2025-09-19 05:29:23] [INFO] Production validation passed
[2025-09-19 05:32:11] [INFO] Production validation passed
[2025-09-19 05:32:11] [INFO] Enrolling agent with manager...
[2025-09-19 05:32:11] [INFO] Agent enrollment configuration:
[2025-09-19 05:32:11] [INFO]   Manager: localhost:1514
[2025-09-19 05:32:11] [INFO]   Agent name: DESKTOP-IVBQT1T
[2025-09-19 05:32:56] [DEBUG] Decoded base64 client key: 001 windows-test any bc5ed1ea8a3f27d13e905c43f6a6fde4c59ac9b49ae2397de58aa2b93c521edf
[2025-09-19 05:32:56] [DEBUG] Client key validation passed
[2025-09-19 05:32:56] [DEBUG]   Agent ID: 001
[2025-09-19 05:32:56] [DEBUG]   Agent name: windows-test
[2025-09-19 05:32:56] [DEBUG]   Agent IP: any (will be preserved in client.keys)
[2025-09-19 05:32:56] [DEBUG]   Key length: 64 characters
[2025-09-19 05:32:56] [INFO] Updating agent configuration...
[2025-09-19 05:32:56] [INFO] Setting up client authentication...
[2025-09-19 05:32:56] [INFO] ✅ Agent enrollment completed successfully!
[2025-09-19 05:32:56] [INFO]    Agent ID: 001
[2025-09-19 05:32:56] [INFO]    Agent name: windows-test
[2025-09-19 05:32:56] [INFO]    Agent IP: any
[2025-09-19 05:32:56] [INFO]    Manager: localhost:1514
[2025-09-19 05:32:56] [INFO]    Configuration updated: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\etc\OSSEC.CONF
[2025-09-19 05:32:56] [INFO]    Client keys updated: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\etc\client.keys
[2025-09-19 05:32:59] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 05:32:59] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 05:32:59] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 05:32:59] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 05:32:59] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 05:33:00] [INFO] Environment setup completed
[2025-09-19 05:33:00] [DEBUG] Checking for disabled agent connection...
[2025-09-19 05:33:00] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 05:33:00] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 05:33:00] [DEBUG] Signal handlers configured for Windows
[2025-09-19 05:33:00] [DEBUG] State tracking initialized
[2025-09-19 05:33:00] [INFO] Starting monitoring-agentd...
[2025-09-19 05:33:00] [DEBUG] Setting up Windows agent environment...
[2025-09-19 05:33:00] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 05:33:00] [DEBUG] Copied client.keys to bin directory
[2025-09-19 05:33:00] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 05:33:00] [DEBUG] Copied local_internal_options.conf to bin directory
[2025-09-19 05:33:00] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 05:33:00] [DEBUG] Copied bypass.dll to bin directory
[2025-09-19 05:33:00] [DEBUG] Copied dbsync.dll to bin directory
[2025-09-19 05:33:00] [DEBUG] Copied fimdb.dll to bin directory
[2025-09-19 05:33:00] [DEBUG] Copied LIBGCC_S_DW2_1.DLL to bin directory
[2025-09-19 05:33:00] [DEBUG] Copied LIBSTDCPP_6.DLL to bin directory
[2025-09-19 05:33:00] [DEBUG] Copied libwazuhext.dll to bin directory
[2025-09-19 05:33:00] [DEBUG] Copied libwazuhshared.dll to bin directory
[2025-09-19 05:33:00] [DEBUG] Copied LIBWINPTHREAD_1.DLL to bin directory
[2025-09-19 05:33:00] [DEBUG] Copied rsync.dll to bin directory
[2025-09-19 05:33:00] [DEBUG] Copied syscollector.dll to bin directory
[2025-09-19 05:33:00] [DEBUG] Copied sysinfo.dll to bin directory
[2025-09-19 05:33:00] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 05:33:00] [DEBUG] Copied client.keys to bin directory
[2025-09-19 05:33:00] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 05:33:00] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 05:33:00] [INFO] Starting Monitoring Agent as process...
[2025-09-19 05:33:03] [WARN] Process started but exited immediately
[2025-09-19 05:33:03] [DEBUG] Recent log entries: [2025-09-19 05:33:00] [DEBUG] Copied client.keys to bin directory; [2025-09-19 05:33:00] [DEBUG] Copied internal_options.conf to bin directory; [2025-09-19 05:33:00] [DEBUG] Copied wpk_root.pem to bin directory; [2025-09-19 05:33:00] [INFO] Starting Monitoring Agent as process...; [2025-09-19 05:33:03] [WARN] Process started but exited immediately
[2025-09-19 05:33:03] [INFO] Trying service method as fallback...
[2025-09-19 05:33:03] [INFO] Starting Monitoring Agent service...
[2025-09-19 05:33:06] [WARN] Service attempt 1/5 - Status: StopPending
[2025-09-19 05:33:06] [INFO] Retrying service start...
[2025-09-19 05:33:11] [WARN] Service attempt 2/5 - Status: StopPending
[2025-09-19 05:33:11] [INFO] Retrying service start...
[2025-09-19 05:33:16] [WARN] Service attempt 3/5 - Status: Stopped
[2025-09-19 05:33:16] [INFO] Retrying service start...
[2025-09-19 05:33:19] [WARN] Service attempt 4/5 - Status: StopPending
[2025-09-19 05:33:19] [INFO] Retrying service start...
[2025-09-19 05:33:24] [WARN] Service attempt 5/5 - Status: StopPending
[2025-09-19 05:33:24] [ERROR] Failed to start Monitoring Agent service after 5 attempts
[2025-09-19 05:33:24] [INFO] Attempting alternative process start method...
[2025-09-19 05:35:29] [INFO] Production validation passed
[2025-09-19 05:35:29] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 05:35:29] [DEBUG] Validating configuration...
[2025-09-19 05:35:29] [DEBUG] Configuration validation passed
[2025-09-19 05:35:29] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 05:35:29] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 05:35:29] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 05:35:29] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 05:35:29] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 05:35:29] [INFO] Environment setup completed
[2025-09-19 05:35:29] [DEBUG] Checking for disabled agent connection...
[2025-09-19 05:35:29] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 05:35:29] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 05:35:29] [DEBUG] Signal handlers configured for Windows
[2025-09-19 05:35:29] [DEBUG] State tracking initialized
[2025-09-19 05:35:29] [INFO] Starting monitoring-agentd...
[2025-09-19 05:35:29] [DEBUG] Setting up Windows agent environment...
[2025-09-19 05:35:29] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 05:35:29] [DEBUG] Copied client.keys to bin directory
[2025-09-19 05:35:29] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 05:35:29] [DEBUG] Copied local_internal_options.conf to bin directory
[2025-09-19 05:35:29] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 05:35:29] [DEBUG] Copied bypass.dll to bin directory
[2025-09-19 05:35:29] [DEBUG] Copied dbsync.dll to bin directory
[2025-09-19 05:35:29] [DEBUG] Copied fimdb.dll to bin directory
[2025-09-19 05:35:29] [DEBUG] Copied LIBGCC_S_DW2_1.DLL to bin directory
[2025-09-19 05:35:29] [DEBUG] Copied LIBSTDCPP_6.DLL to bin directory
[2025-09-19 05:35:29] [DEBUG] Copied libwazuhext.dll to bin directory
[2025-09-19 05:35:29] [DEBUG] Copied libwazuhshared.dll to bin directory
[2025-09-19 05:35:29] [DEBUG] Copied LIBWINPTHREAD_1.DLL to bin directory
[2025-09-19 05:35:29] [DEBUG] Copied rsync.dll to bin directory
[2025-09-19 05:35:29] [DEBUG] Copied syscollector.dll to bin directory
[2025-09-19 05:35:29] [DEBUG] Copied sysinfo.dll to bin directory
[2025-09-19 05:35:29] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 05:35:29] [DEBUG] Copied client.keys to bin directory
[2025-09-19 05:35:29] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 05:35:29] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 05:35:29] [INFO] Starting Monitoring Agent as process...
[2025-09-19 05:35:33] [WARN] Process started but exited immediately
[2025-09-19 05:35:33] [DEBUG] Recent log entries: [2025-09-19 05:35:29] [DEBUG] Copied client.keys to bin directory; [2025-09-19 05:35:29] [DEBUG] Copied internal_options.conf to bin directory; [2025-09-19 05:35:29] [DEBUG] Copied wpk_root.pem to bin directory; [2025-09-19 05:35:29] [INFO] Starting Monitoring Agent as process...; [2025-09-19 05:35:33] [WARN] Process started but exited immediately
[2025-09-19 05:35:33] [INFO] Trying service method as fallback...
[2025-09-19 05:35:33] [INFO] Starting Monitoring Agent service...
[2025-09-19 05:35:36] [WARN] Service attempt 1/5 - Status: StopPending
[2025-09-19 05:35:36] [INFO] Retrying service start...
[2025-09-19 05:35:41] [WARN] Service attempt 2/5 - Status: StopPending
[2025-09-19 05:35:41] [INFO] Retrying service start...
[2025-09-19 05:35:46] [WARN] Service attempt 3/5 - Status: Stopped
[2025-09-19 05:35:46] [INFO] Retrying service start...
[2025-09-19 05:35:49] [WARN] Service attempt 4/5 - Status: StopPending
[2025-09-19 05:35:49] [INFO] Retrying service start...
[2025-09-19 05:35:54] [WARN] Service attempt 5/5 - Status: Stopped
[2025-09-19 05:35:54] [ERROR] Failed to start Monitoring Agent service after 5 attempts
[2025-09-19 05:35:54] [INFO] Attempting alternative process start method...
[2025-09-19 05:36:33] [INFO] Production validation passed
[2025-09-19 05:36:33] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 05:36:33] [DEBUG] Validating configuration...
[2025-09-19 05:36:33] [DEBUG] Configuration validation passed
[2025-09-19 05:36:33] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 05:36:33] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 05:36:33] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 05:36:33] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 05:36:33] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 05:36:33] [INFO] Environment setup completed
[2025-09-19 05:36:33] [DEBUG] Checking for disabled agent connection...
[2025-09-19 05:36:33] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 05:36:33] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 05:36:33] [DEBUG] Signal handlers configured for Windows
[2025-09-19 05:36:33] [DEBUG] State tracking initialized
[2025-09-19 05:36:33] [INFO] Starting monitoring-agentd...
[2025-09-19 05:36:33] [DEBUG] Setting up Windows agent environment...
[2025-09-19 05:36:33] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 05:36:33] [DEBUG] Copied client.keys to bin directory
[2025-09-19 05:36:33] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 05:36:33] [DEBUG] Copied local_internal_options.conf to bin directory
[2025-09-19 05:36:33] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 05:36:33] [DEBUG] Copied bypass.dll to bin directory
[2025-09-19 05:36:33] [DEBUG] Copied dbsync.dll to bin directory
[2025-09-19 05:36:33] [DEBUG] Copied fimdb.dll to bin directory
[2025-09-19 05:36:33] [DEBUG] Copied LIBGCC_S_DW2_1.DLL to bin directory
[2025-09-19 05:36:33] [DEBUG] Copied LIBSTDCPP_6.DLL to bin directory
[2025-09-19 05:36:33] [DEBUG] Copied libwazuhext.dll to bin directory
[2025-09-19 05:36:33] [DEBUG] Copied libwazuhshared.dll to bin directory
[2025-09-19 05:36:33] [DEBUG] Copied LIBWINPTHREAD_1.DLL to bin directory
[2025-09-19 05:36:33] [DEBUG] Copied rsync.dll to bin directory
[2025-09-19 05:36:33] [DEBUG] Copied syscollector.dll to bin directory
[2025-09-19 05:36:33] [DEBUG] Copied sysinfo.dll to bin directory
[2025-09-19 05:36:33] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 05:36:33] [DEBUG] Copied client.keys to bin directory
[2025-09-19 05:36:33] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 05:36:33] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 05:36:33] [INFO] Starting Monitoring Agent as process...
[2025-09-19 05:36:36] [WARN] Process started but exited immediately
[2025-09-19 05:36:36] [DEBUG] Recent log entries: [2025-09-19 05:36:33] [DEBUG] Copied client.keys to bin directory; [2025-09-19 05:36:33] [DEBUG] Copied internal_options.conf to bin directory; [2025-09-19 05:36:33] [DEBUG] Copied wpk_root.pem to bin directory; [2025-09-19 05:36:33] [INFO] Starting Monitoring Agent as process...; [2025-09-19 05:36:36] [WARN] Process started but exited immediately
[2025-09-19 05:36:36] [INFO] Trying service method as fallback...
[2025-09-19 05:36:36] [INFO] Starting Monitoring Agent service...
[2025-09-19 05:36:39] [WARN] Service attempt 1/5 - Status: StopPending
[2025-09-19 05:36:39] [INFO] Retrying service start...
[2025-09-19 05:36:45] [WARN] Service attempt 2/5 - Status: Stopped
[2025-09-19 05:36:45] [INFO] Retrying service start...
[2025-09-19 05:36:48] [WARN] Service attempt 3/5 - Status: StopPending
[2025-09-19 05:36:48] [INFO] Retrying service start...
[2025-09-19 05:36:53] [WARN] Service attempt 4/5 - Status: Stopped
[2025-09-19 05:36:53] [INFO] Retrying service start...
[2025-09-19 05:36:56] [WARN] Service attempt 5/5 - Status: StopPending
[2025-09-19 05:36:56] [ERROR] Failed to start Monitoring Agent service after 5 attempts
[2025-09-19 05:36:56] [INFO] Attempting alternative process start method...
[2025-09-19 05:36:59] [INFO] ✓ Started agent as process with PID: 15264
[2025-09-19 05:37:06] [INFO] Production validation passed
[2025-09-19 05:46:16] [INFO] Production validation passed
[2025-09-19 05:49:16] [INFO] Production validation passed
[2025-09-19 05:49:16] [INFO] Enrolling agent with manager...
[2025-09-19 05:49:16] [INFO] Agent enrollment configuration:
[2025-09-19 05:49:16] [INFO]   Manager: localhost:1514
[2025-09-19 05:49:16] [INFO]   Agent name: DESKTOP-IVBQT1T
[2025-09-19 05:50:17] [DEBUG] Decoded base64 client key: 001 windows-testing any 29ce0530214d5282175900466a5a8a5af3fea39a68d6ce0179c073ba1c6bd5ed
[2025-09-19 05:50:17] [DEBUG] Client key validation passed
[2025-09-19 05:50:17] [DEBUG]   Agent ID: 001
[2025-09-19 05:50:17] [DEBUG]   Agent name: windows-testing
[2025-09-19 05:50:17] [DEBUG]   Agent IP: any (will be preserved in client.keys)
[2025-09-19 05:50:17] [DEBUG]   Key length: 64 characters
[2025-09-19 05:50:17] [INFO] Updating agent configuration...
[2025-09-19 05:50:17] [INFO] Setting up client authentication...
[2025-09-19 05:50:17] [INFO] ✅ Agent enrollment completed successfully!
[2025-09-19 05:50:17] [INFO]    Agent ID: 001
[2025-09-19 05:50:17] [INFO]    Agent name: windows-testing
[2025-09-19 05:50:17] [INFO]    Agent IP: any
[2025-09-19 05:50:17] [INFO]    Manager: localhost:1514
[2025-09-19 05:50:17] [INFO]    Configuration updated: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\etc\OSSEC.CONF
[2025-09-19 05:50:17] [INFO]    Client keys updated: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\etc\client.keys
[2025-09-19 05:50:20] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 05:50:20] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 05:50:20] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 05:50:20] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 05:50:20] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 05:50:20] [INFO] Environment setup completed
[2025-09-19 05:50:20] [DEBUG] Checking for disabled agent connection...
[2025-09-19 05:50:20] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 05:50:20] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 05:50:20] [DEBUG] Signal handlers configured for Windows
[2025-09-19 05:50:20] [DEBUG] State tracking initialized
[2025-09-19 05:50:20] [INFO] monitoring-agentd already running...
[2025-09-19 05:50:20] [DEBUG] Completing fault tolerance startup for Windows...
[2025-09-19 05:50:20] [DEBUG] Initializing recovery system for Windows...
[2025-09-19 05:50:20] [DEBUG] Recovery system initialized
[2025-09-19 05:50:20] [INFO] ✓ Monitoring Agent started successfully with fault tolerance!
[2025-09-19 05:50:45] [INFO] Production validation passed
[2025-09-19 05:50:55] [INFO] Production validation passed
[2025-09-19 05:50:55] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 05:50:55] [DEBUG] Validating configuration...
[2025-09-19 05:50:55] [DEBUG] Configuration validation passed
[2025-09-19 05:50:55] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 05:50:55] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 05:50:55] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 05:50:55] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 05:50:55] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 05:50:55] [INFO] Environment setup completed
[2025-09-19 05:50:55] [DEBUG] Checking for disabled agent connection...
[2025-09-19 05:50:55] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 05:50:55] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 05:50:55] [DEBUG] Signal handlers configured for Windows
[2025-09-19 05:50:55] [DEBUG] State tracking initialized
[2025-09-19 05:50:55] [INFO] monitoring-agentd already running...
[2025-09-19 05:50:55] [DEBUG] Completing fault tolerance startup for Windows...
[2025-09-19 05:50:55] [DEBUG] Initializing recovery system for Windows...
[2025-09-19 05:50:55] [DEBUG] Recovery system initialized
[2025-09-19 05:50:55] [INFO] ✓ Monitoring Agent started successfully with fault tolerance!
[2025-09-19 05:54:37] [INFO] Production validation passed
[2025-09-19 05:54:37] [INFO] Production validation passed
[2025-09-19 05:54:37] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 05:54:37] [DEBUG] Validating configuration...
[2025-09-19 05:54:37] [DEBUG] Configuration validation passed
[2025-09-19 05:54:37] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 05:54:37] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 05:54:37] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 05:54:37] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 05:54:37] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 05:54:37] [INFO] Environment setup completed
[2025-09-19 05:54:37] [DEBUG] Checking for disabled agent connection...
[2025-09-19 05:54:37] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 05:54:37] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 05:54:37] [DEBUG] Signal handlers configured for Windows
[2025-09-19 05:54:37] [DEBUG] State tracking initialized
[2025-09-19 05:54:37] [INFO] Starting monitoring-agentd...
[2025-09-19 05:54:37] [DEBUG] Setting up Windows agent environment...
[2025-09-19 05:54:37] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 05:54:37] [DEBUG] Copied client.keys to bin directory
[2025-09-19 05:54:37] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 05:54:38] [DEBUG] Copied local_internal_options.conf to bin directory
[2025-09-19 05:54:38] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 05:54:38] [DEBUG] Copied bypass.dll to bin directory
[2025-09-19 05:54:38] [DEBUG] Copied dbsync.dll to bin directory
[2025-09-19 05:54:38] [DEBUG] Copied fimdb.dll to bin directory
[2025-09-19 05:54:38] [DEBUG] Copied LIBGCC_S_DW2_1.DLL to bin directory
[2025-09-19 05:54:38] [DEBUG] Copied LIBSTDCPP_6.DLL to bin directory
[2025-09-19 05:54:38] [DEBUG] Copied libwazuhext.dll to bin directory
[2025-09-19 05:54:38] [DEBUG] Copied libwazuhshared.dll to bin directory
[2025-09-19 05:54:38] [DEBUG] Copied LIBWINPTHREAD_1.DLL to bin directory
[2025-09-19 05:54:38] [DEBUG] Copied rsync.dll to bin directory
[2025-09-19 05:54:38] [DEBUG] Copied syscollector.dll to bin directory
[2025-09-19 05:54:38] [DEBUG] Copied sysinfo.dll to bin directory
[2025-09-19 05:54:38] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 05:54:38] [DEBUG] Copied OSSEC.CONF to bin directory
[2025-09-19 05:54:38] [DEBUG] Copied client.keys to bin directory
[2025-09-19 05:54:38] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 05:54:38] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 05:54:38] [INFO] Installing and starting Monitoring Agent service...
[2025-09-19 05:54:38] [DEBUG] Service install result: 2025/09/19 05:54:38 wazuh-agent: INFO: Found (WazuhSvc) service is not running. System.Management.Automation.RemoteException 2025/09/19 05:54:38 wazuh-agent: INFO: Successfully removed (WazuhSvc) from the service database. System.Management.Automation.RemoteException 2025/09/19 05:54:38 wazuh-agent: INFO: Successfully added to the service database. System.Management.Automation.RemoteException
[2025-09-19 05:54:43] [WARN] Service installation attempted but not running, trying process method
[2025-09-19 05:54:43] [INFO] Starting Monitoring Agent as process...
[2025-09-19 05:54:46] [WARN] Process started but exited immediately
[2025-09-19 05:54:46] [DEBUG] Recent log entries: [2025-09-19 05:54:38] [INFO] Installing and starting Monitoring Agent service...; [2025-09-19 05:54:38] [DEBUG] Service install result: 2025/09/19 05:54:38 wazuh-agent: INFO: Found (WazuhSvc) service is not running. System.Management.Automation.RemoteException 2025/09/19 05:54:38 wazuh-agent: INFO: Successfully removed (WazuhSvc) from the service database. System.Management.Automation.RemoteException 2025/09/19 05:54:38 wazuh-agent: INFO: Successfully added to the service database. System.Management.Automation.RemoteException; [2025-09-19 05:54:43] [WARN] Service installation attempted but not running, trying process method; [2025-09-19 05:54:43] [INFO] Starting Monitoring Agent as process...; [2025-09-19 05:54:46] [WARN] Process started but exited immediately
[2025-09-19 05:54:46] [INFO] Trying service method as fallback...
[2025-09-19 05:54:46] [INFO] Starting Monitoring Agent service...
[2025-09-19 05:54:51] [WARN] Service attempt 1/5 - Status: Stopped
[2025-09-19 05:54:51] [INFO] Retrying service start...
[2025-09-19 05:54:54] [WARN] Service attempt 2/5 - Status: StopPending
[2025-09-19 05:54:54] [INFO] Retrying service start...
[2025-09-19 05:55:00] [WARN] Service attempt 3/5 - Status: StopPending
[2025-09-19 05:55:00] [INFO] Retrying service start...
[2025-09-19 05:55:05] [WARN] Service attempt 4/5 - Status: Stopped
[2025-09-19 05:55:05] [INFO] Retrying service start...
[2025-09-19 05:55:08] [WARN] Service attempt 5/5 - Status: StopPending
[2025-09-19 05:55:08] [ERROR] Failed to start Monitoring Agent service after 5 attempts
[2025-09-19 05:55:08] [INFO] Attempting alternative process start method...
[2025-09-19 05:55:11] [INFO] ✓ Started agent as process with PID: 16632
[2025-09-19 05:56:08] [INFO] Production validation passed
[2025-09-19 05:59:30] [INFO] Production validation passed
[2025-09-19 06:02:16] [INFO] Production validation passed
[2025-09-19 06:02:16] [INFO] Stopping Monitoring Agent v4.8.0 and Fault Tolerance...
[2025-09-19 06:02:16] [INFO] Windows services not available on this platform
[2025-09-19 06:02:16] [INFO] Forcing agent disconnection from Wazuh manager...
[2025-09-19 06:02:16] [INFO] Agent ID: 001 - temporarily disabling connection
[2025-09-19 06:02:16] [INFO] Agent authentication disabled - will appear as disconnected
[2025-09-19 06:02:18] [DEBUG] Stopping fault tolerance components for Windows...
[2025-09-19 06:02:21] [INFO] MONITORING_AGENT not running...
[2025-09-19 06:02:21] [INFO] monitoring-agentd not running...
[2025-09-19 06:02:21] [INFO] Monitoring Agent v4.8.0 Stopped
[2025-09-19 06:02:27] [INFO] Production validation passed
[2025-09-19 06:02:27] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 06:02:27] [DEBUG] Validating configuration...
[2025-09-19 06:02:27] [DEBUG] Configuration validation passed
[2025-09-19 06:02:27] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 06:02:27] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 06:02:27] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 06:02:27] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 06:02:27] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 06:02:27] [INFO] Environment setup completed
[2025-09-19 06:02:27] [DEBUG] Checking for disabled agent connection...
[2025-09-19 06:02:27] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 06:02:27] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 06:02:27] [DEBUG] Signal handlers configured for Windows
[2025-09-19 06:02:27] [DEBUG] State tracking initialized
[2025-09-19 06:02:27] [INFO] Starting monitoring-agentd...
[2025-09-19 06:02:27] [DEBUG] Setting up Windows agent environment...
[2025-09-19 06:02:27] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 06:02:27] [DEBUG] Copied client.keys to bin directory
[2025-09-19 06:02:27] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 06:02:27] [DEBUG] Copied local_internal_options.conf to bin directory
[2025-09-19 06:02:27] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 06:02:27] [DEBUG] Copied bypass.dll to bin directory
[2025-09-19 06:02:27] [DEBUG] Copied dbsync.dll to bin directory
[2025-09-19 06:02:27] [DEBUG] Copied fimdb.dll to bin directory
[2025-09-19 06:02:27] [DEBUG] Copied LIBGCC_S_DW2_1.DLL to bin directory
[2025-09-19 06:02:27] [DEBUG] Copied LIBSTDCPP_6.DLL to bin directory
[2025-09-19 06:02:27] [DEBUG] Copied libwazuhext.dll to bin directory
[2025-09-19 06:02:27] [DEBUG] Copied libwazuhshared.dll to bin directory
[2025-09-19 06:02:27] [DEBUG] Copied LIBWINPTHREAD_1.DLL to bin directory
[2025-09-19 06:02:27] [DEBUG] Copied rsync.dll to bin directory
[2025-09-19 06:02:27] [DEBUG] Copied syscollector.dll to bin directory
[2025-09-19 06:02:27] [DEBUG] Copied sysinfo.dll to bin directory
[2025-09-19 06:02:27] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 06:02:27] [DEBUG] Copied OSSEC.CONF to bin directory
[2025-09-19 06:02:27] [DEBUG] Copied client.keys to bin directory
[2025-09-19 06:02:27] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 06:02:27] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 06:02:27] [INFO] Installing and starting Monitoring Agent service...
[2025-09-19 06:02:27] [DEBUG] Service install result: 2025/09/19 06:02:27 wazuh-agent: INFO: Found (WazuhSvc) service is not running. System.Management.Automation.RemoteException 2025/09/19 06:02:27 wazuh-agent: INFO: Successfully removed (WazuhSvc) from the service database. System.Management.Automation.RemoteException 2025/09/19 06:02:27 wazuh-agent: INFO: Successfully added to the service database. System.Management.Automation.RemoteException
[2025-09-19 06:02:32] [WARN] Service installation attempted but not running, trying process method
[2025-09-19 06:02:32] [INFO] Starting Monitoring Agent as process...
[2025-09-19 06:02:35] [WARN] Process started but exited immediately
[2025-09-19 06:02:35] [DEBUG] Recent log entries: [2025-09-19 06:02:27] [INFO] Installing and starting Monitoring Agent service...; [2025-09-19 06:02:27] [DEBUG] Service install result: 2025/09/19 06:02:27 wazuh-agent: INFO: Found (WazuhSvc) service is not running. System.Management.Automation.RemoteException 2025/09/19 06:02:27 wazuh-agent: INFO: Successfully removed (WazuhSvc) from the service database. System.Management.Automation.RemoteException 2025/09/19 06:02:27 wazuh-agent: INFO: Successfully added to the service database. System.Management.Automation.RemoteException; [2025-09-19 06:02:32] [WARN] Service installation attempted but not running, trying process method; [2025-09-19 06:02:32] [INFO] Starting Monitoring Agent as process...; [2025-09-19 06:02:35] [WARN] Process started but exited immediately
[2025-09-19 06:02:35] [INFO] Trying service method as fallback...
[2025-09-19 06:02:35] [INFO] Starting Monitoring Agent service...
[2025-09-19 06:02:40] [WARN] Service attempt 1/5 - Status: Stopped
[2025-09-19 06:02:40] [INFO] Retrying service start...
[2025-09-19 06:02:44] [WARN] Service attempt 2/5 - Status: StopPending
[2025-09-19 06:02:44] [INFO] Retrying service start...
[2025-09-19 06:02:49] [WARN] Service attempt 3/5 - Status: StopPending
[2025-09-19 06:02:49] [INFO] Retrying service start...
[2025-09-19 06:02:54] [WARN] Service attempt 4/5 - Status: Stopped
[2025-09-19 06:02:54] [INFO] Retrying service start...
[2025-09-19 06:02:57] [WARN] Service attempt 5/5 - Status: StopPending
[2025-09-19 06:02:57] [ERROR] Failed to start Monitoring Agent service after 5 attempts
[2025-09-19 06:02:57] [INFO] Attempting alternative process start method...
[2025-09-19 06:03:00] [INFO] ✓ Started agent as process with PID: 25060
[2025-09-19 06:03:10] [INFO] Production validation passed
[2025-09-19 06:06:15] [INFO] Production validation passed
[2025-09-19 06:06:15] [INFO] Stopping Monitoring Agent v4.8.0 and Fault Tolerance...
[2025-09-19 06:06:15] [INFO] Windows services not available on this platform
[2025-09-19 06:06:15] [INFO] Forcing agent disconnection from Wazuh manager...
[2025-09-19 06:06:15] [INFO] Agent ID: 001 - temporarily disabling connection
[2025-09-19 06:06:15] [INFO] Agent authentication disabled - will appear as disconnected
[2025-09-19 06:06:17] [DEBUG] Stopping fault tolerance components for Windows...
[2025-09-19 06:06:20] [INFO] MONITORING_AGENT not running...
[2025-09-19 06:06:20] [INFO] monitoring-agentd not running...
[2025-09-19 06:06:20] [INFO] Monitoring Agent v4.8.0 Stopped
[2025-09-19 06:11:12] [INFO] Production validation passed
[2025-09-19 06:12:29] [INFO] Production validation passed
[2025-09-19 06:12:29] [ERROR] Unhandled exception: Cannot bind argument to parameter 'Path' because it is null.
[2025-09-19 06:12:29] [DEBUG] Stack trace:    at System.Management.Automation.ExceptionHandlingOps.CheckActionPreference(FunctionContext funcContext, Exception exception)
   at System.Management.Automation.Interpreter.ActionCallInstruction`2.Run(InterpretedFrame frame)
   at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)
   at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)
[2025-09-19 06:12:48] [INFO] Production validation passed
[2025-09-19 06:12:49] [ERROR] Unhandled exception: Cannot bind argument to parameter 'Path' because it is null.
[2025-09-19 06:12:49] [DEBUG] Stack trace:    at System.Management.Automation.ExceptionHandlingOps.CheckActionPreference(FunctionContext funcContext, Exception exception)
   at System.Management.Automation.Interpreter.ActionCallInstruction`2.Run(InterpretedFrame frame)
   at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)
   at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)
[2025-09-19 06:13:59] [INFO] Production validation passed
[2025-09-19 06:14:22] [INFO] Production validation passed
[2025-09-19 06:19:55] [INFO] Production validation passed
[2025-09-19 06:20:03] [INFO] Production validation passed
[2025-09-19 06:20:03] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 06:20:03] [DEBUG] Validating configuration...
[2025-09-19 06:20:03] [DEBUG] Configuration validation passed
[2025-09-19 06:20:03] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 06:20:03] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 06:20:03] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 06:20:03] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 06:20:03] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 06:20:03] [INFO] Environment setup completed
[2025-09-19 06:20:03] [DEBUG] Checking for disabled agent connection...
[2025-09-19 06:20:03] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 06:20:03] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 06:20:03] [DEBUG] Signal handlers configured for Windows
[2025-09-19 06:20:03] [DEBUG] State tracking initialized
[2025-09-19 06:20:03] [INFO] Starting monitoring-agentd...
[2025-09-19 06:20:03] [DEBUG] Setting up Windows agent environment...
[2025-09-19 06:20:03] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 06:20:03] [DEBUG] Copied client.keys to bin directory
[2025-09-19 06:20:03] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 06:20:03] [DEBUG] Copied local_internal_options.conf to bin directory
[2025-09-19 06:20:03] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 06:20:03] [DEBUG] Copied bypass.dll to bin directory
[2025-09-19 06:20:03] [DEBUG] Copied dbsync.dll to bin directory
[2025-09-19 06:20:03] [DEBUG] Copied fimdb.dll to bin directory
[2025-09-19 06:20:03] [DEBUG] Copied LIBGCC_S_DW2_1.DLL to bin directory
[2025-09-19 06:20:03] [DEBUG] Copied LIBSTDCPP_6.DLL to bin directory
[2025-09-19 06:20:03] [DEBUG] Copied libwazuhext.dll to bin directory
[2025-09-19 06:20:03] [DEBUG] Copied libwazuhshared.dll to bin directory
[2025-09-19 06:20:03] [DEBUG] Copied LIBWINPTHREAD_1.DLL to bin directory
[2025-09-19 06:20:03] [DEBUG] Copied rsync.dll to bin directory
[2025-09-19 06:20:03] [DEBUG] Copied syscollector.dll to bin directory
[2025-09-19 06:20:03] [DEBUG] Copied sysinfo.dll to bin directory
[2025-09-19 06:20:03] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 06:20:03] [DEBUG] Copied OSSEC.CONF to bin directory
[2025-09-19 06:20:03] [DEBUG] Copied client.keys to bin directory
[2025-09-19 06:20:03] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 06:20:03] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 06:20:03] [INFO] Installing and starting Monitoring Agent service...
[2025-09-19 06:20:03] [DEBUG] Service install result: 2025/09/19 06:20:03 wazuh-agent: INFO: Found (WazuhSvc) service is not running. System.Management.Automation.RemoteException 2025/09/19 06:20:03 wazuh-agent: INFO: Successfully removed (WazuhSvc) from the service database. System.Management.Automation.RemoteException 2025/09/19 06:20:03 wazuh-agent: INFO: Successfully added to the service database. System.Management.Automation.RemoteException
[2025-09-19 06:20:08] [WARN] Service installation attempted but not running, trying process method
[2025-09-19 06:20:08] [INFO] Starting Monitoring Agent as process...
[2025-09-19 06:20:11] [WARN] Process started but exited immediately
[2025-09-19 06:20:12] [DEBUG] Recent log entries: [2025-09-19 06:20:03] [INFO] Installing and starting Monitoring Agent service...; [2025-09-19 06:20:03] [DEBUG] Service install result: 2025/09/19 06:20:03 wazuh-agent: INFO: Found (WazuhSvc) service is not running. System.Management.Automation.RemoteException 2025/09/19 06:20:03 wazuh-agent: INFO: Successfully removed (WazuhSvc) from the service database. System.Management.Automation.RemoteException 2025/09/19 06:20:03 wazuh-agent: INFO: Successfully added to the service database. System.Management.Automation.RemoteException; [2025-09-19 06:20:08] [WARN] Service installation attempted but not running, trying process method; [2025-09-19 06:20:08] [INFO] Starting Monitoring Agent as process...; [2025-09-19 06:20:11] [WARN] Process started but exited immediately
[2025-09-19 06:20:12] [INFO] Trying service method as fallback...
[2025-09-19 06:20:12] [INFO] Starting Monitoring Agent service...
[2025-09-19 06:20:17] [WARN] Service attempt 1/5 - Status: Stopped
[2025-09-19 06:20:17] [INFO] Retrying service start...
[2025-09-19 06:20:20] [WARN] Service attempt 2/5 - Status: StopPending
[2025-09-19 06:20:20] [INFO] Retrying service start...
[2025-09-19 06:20:25] [WARN] Service attempt 3/5 - Status: StopPending
[2025-09-19 06:20:25] [INFO] Retrying service start...
[2025-09-19 06:20:30] [WARN] Service attempt 4/5 - Status: Stopped
[2025-09-19 06:20:30] [INFO] Retrying service start...
[2025-09-19 06:20:33] [WARN] Service attempt 5/5 - Status: StopPending
[2025-09-19 06:20:33] [ERROR] Failed to start Monitoring Agent service after 5 attempts
[2025-09-19 06:20:33] [INFO] Attempting alternative process start method...
[2025-09-19 06:20:36] [INFO] ✓ Started agent as process with PID: 25204
[2025-09-19 06:20:50] [INFO] Production validation passed
[2025-09-19 06:20:50] [INFO] Stopping Monitoring Agent v4.8.0 and Fault Tolerance...
[2025-09-19 06:20:50] [INFO] Windows services not available on this platform
[2025-09-19 06:20:50] [INFO] Forcing agent disconnection from Wazuh manager...
[2025-09-19 06:20:50] [INFO] Agent ID: 001 - temporarily disabling connection
[2025-09-19 06:20:50] [INFO] Agent authentication disabled - will appear as disconnected
[2025-09-19 06:20:52] [DEBUG] Stopping fault tolerance components for Windows...
[2025-09-19 06:20:55] [INFO] MONITORING_AGENT not running...
[2025-09-19 06:20:55] [INFO] monitoring-agentd not running...
[2025-09-19 06:20:55] [INFO] Monitoring Agent v4.8.0 Stopped
[2025-09-19 06:21:03] [INFO] Production validation passed
[2025-09-19 06:24:59] [INFO] Production validation passed
[2025-09-19 06:25:18] [INFO] Production validation passed
[2025-09-19 06:25:18] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 06:25:18] [DEBUG] Validating configuration...
[2025-09-19 06:25:18] [DEBUG] Configuration validation passed
[2025-09-19 06:25:18] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 06:25:18] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 06:25:18] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 06:25:18] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 06:25:18] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 06:25:18] [INFO] Environment setup completed
[2025-09-19 06:25:18] [DEBUG] Checking for disabled agent connection...
[2025-09-19 06:25:18] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 06:25:18] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 06:25:18] [DEBUG] Signal handlers configured for Windows
[2025-09-19 06:25:18] [DEBUG] State tracking initialized
[2025-09-19 06:25:18] [INFO] Starting monitoring-agentd...
[2025-09-19 06:25:18] [DEBUG] Setting up Windows agent environment...
[2025-09-19 06:25:18] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 06:25:18] [DEBUG] Copied client.keys to bin directory
[2025-09-19 06:25:18] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 06:25:18] [DEBUG] Copied local_internal_options.conf to bin directory
[2025-09-19 06:25:18] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 06:25:18] [DEBUG] Copied bypass.dll to bin directory
[2025-09-19 06:25:19] [DEBUG] Copied dbsync.dll to bin directory
[2025-09-19 06:25:19] [DEBUG] Copied fimdb.dll to bin directory
[2025-09-19 06:25:19] [DEBUG] Copied LIBGCC_S_DW2_1.DLL to bin directory
[2025-09-19 06:25:19] [DEBUG] Copied LIBSTDCPP_6.DLL to bin directory
[2025-09-19 06:25:20] [DEBUG] Copied libwazuhext.dll to bin directory
[2025-09-19 06:25:20] [DEBUG] Copied libwazuhshared.dll to bin directory
[2025-09-19 06:25:20] [DEBUG] Copied LIBWINPTHREAD_1.DLL to bin directory
[2025-09-19 06:25:21] [DEBUG] Copied rsync.dll to bin directory
[2025-09-19 06:25:21] [DEBUG] Copied syscollector.dll to bin directory
[2025-09-19 06:25:21] [DEBUG] Copied sysinfo.dll to bin directory
[2025-09-19 06:25:21] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 06:25:21] [DEBUG] Copied OSSEC.CONF to bin directory
[2025-09-19 06:25:21] [DEBUG] Copied client.keys to bin directory
[2025-09-19 06:25:21] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 06:25:21] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 06:25:21] [INFO] Installing and starting Monitoring Agent service...
[2025-09-19 06:25:22] [DEBUG] Service install result: 2025/09/19 06:25:22 wazuh-agent: INFO: Found (WazuhSvc) service is not running. System.Management.Automation.RemoteException 2025/09/19 06:25:22 wazuh-agent: INFO: Successfully removed (WazuhSvc) from the service database. System.Management.Automation.RemoteException 2025/09/19 06:25:22 wazuh-agent: INFO: Successfully added to the service database. System.Management.Automation.RemoteException
[2025-09-19 06:25:27] [WARN] Service installation attempted but not running, trying process method
[2025-09-19 06:25:27] [INFO] Starting Monitoring Agent as process...
[2025-09-19 06:25:30] [WARN] Process started but exited immediately
[2025-09-19 06:25:30] [DEBUG] Recent log entries: [2025-09-19 06:25:21] [INFO] Installing and starting Monitoring Agent service...; [2025-09-19 06:25:22] [DEBUG] Service install result: 2025/09/19 06:25:22 wazuh-agent: INFO: Found (WazuhSvc) service is not running. System.Management.Automation.RemoteException 2025/09/19 06:25:22 wazuh-agent: INFO: Successfully removed (WazuhSvc) from the service database. System.Management.Automation.RemoteException 2025/09/19 06:25:22 wazuh-agent: INFO: Successfully added to the service database. System.Management.Automation.RemoteException; [2025-09-19 06:25:27] [WARN] Service installation attempted but not running, trying process method; [2025-09-19 06:25:27] [INFO] Starting Monitoring Agent as process...; [2025-09-19 06:25:30] [WARN] Process started but exited immediately
[2025-09-19 06:25:30] [INFO] Trying service method as fallback...
[2025-09-19 06:25:30] [INFO] Starting Monitoring Agent service...
[2025-09-19 06:25:35] [WARN] Service attempt 1/5 - Status: StopPending
[2025-09-19 06:25:35] [INFO] Retrying service start...
[2025-09-19 06:25:40] [WARN] Service attempt 2/5 - Status: StopPending
[2025-09-19 06:25:40] [INFO] Retrying service start...
[2025-09-19 06:25:45] [WARN] Service attempt 3/5 - Status: StopPending
[2025-09-19 06:25:45] [INFO] Retrying service start...
[2025-09-19 06:25:50] [WARN] Service attempt 4/5 - Status: StopPending
[2025-09-19 06:25:50] [INFO] Retrying service start...
[2025-09-19 06:25:56] [WARN] Service attempt 5/5 - Status: StopPending
[2025-09-19 06:25:56] [ERROR] Failed to start Monitoring Agent service after 5 attempts
[2025-09-19 06:25:56] [INFO] Attempting alternative process start method...
[2025-09-19 06:25:59] [INFO] ✓ Started agent as process with PID: 7480
[2025-09-19 06:26:19] [INFO] Production validation passed
[2025-09-19 06:26:34] [INFO] Production validation passed
[2025-09-19 06:26:34] [INFO] Stopping Monitoring Agent v4.8.0 and Fault Tolerance...
[2025-09-19 06:26:34] [INFO] Windows services not available on this platform
[2025-09-19 06:26:34] [INFO] Forcing agent disconnection from Wazuh manager...
[2025-09-19 06:26:35] [INFO] Agent ID: 001 - temporarily disabling connection
[2025-09-19 06:26:35] [INFO] Agent authentication disabled - will appear as disconnected
[2025-09-19 06:26:37] [DEBUG] Stopping fault tolerance components for Windows...
[2025-09-19 06:26:40] [INFO] MONITORING_AGENT not running...
[2025-09-19 06:26:40] [INFO] monitoring-agentd not running...
[2025-09-19 06:26:40] [INFO] Monitoring Agent v4.8.0 Stopped
[2025-09-19 06:27:29] [INFO] Production validation passed
[2025-09-19 06:27:29] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 06:27:29] [DEBUG] Validating configuration...
[2025-09-19 06:27:29] [DEBUG] Configuration validation passed
[2025-09-19 06:27:29] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 06:27:29] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 06:27:29] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 06:27:29] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 06:27:29] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 06:27:29] [INFO] Environment setup completed
[2025-09-19 06:27:29] [DEBUG] Checking for disabled agent connection...
[2025-09-19 06:27:29] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 06:27:29] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 06:27:29] [DEBUG] Signal handlers configured for Windows
[2025-09-19 06:27:29] [DEBUG] State tracking initialized
[2025-09-19 06:27:29] [INFO] Starting monitoring-agentd...
[2025-09-19 06:27:29] [DEBUG] Setting up Windows agent environment...
[2025-09-19 06:27:29] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 06:27:29] [DEBUG] Copied client.keys to bin directory
[2025-09-19 06:27:29] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 06:27:29] [DEBUG] Copied local_internal_options.conf to bin directory
[2025-09-19 06:27:29] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 06:27:29] [DEBUG] Copied bypass.dll to bin directory
[2025-09-19 06:27:29] [DEBUG] Copied dbsync.dll to bin directory
[2025-09-19 06:27:29] [DEBUG] Copied fimdb.dll to bin directory
[2025-09-19 06:27:29] [DEBUG] Copied LIBGCC_S_DW2_1.DLL to bin directory
[2025-09-19 06:27:29] [DEBUG] Copied LIBSTDCPP_6.DLL to bin directory
[2025-09-19 06:27:29] [DEBUG] Copied libwazuhext.dll to bin directory
[2025-09-19 06:27:29] [DEBUG] Copied libwazuhshared.dll to bin directory
[2025-09-19 06:27:29] [DEBUG] Copied LIBWINPTHREAD_1.DLL to bin directory
[2025-09-19 06:27:29] [DEBUG] Copied rsync.dll to bin directory
[2025-09-19 06:27:29] [DEBUG] Copied syscollector.dll to bin directory
[2025-09-19 06:27:29] [DEBUG] Copied sysinfo.dll to bin directory
[2025-09-19 06:27:29] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 06:27:29] [DEBUG] Copied OSSEC.CONF to bin directory
[2025-09-19 06:27:29] [DEBUG] Copied client.keys to bin directory
[2025-09-19 06:27:29] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 06:27:29] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 06:27:29] [INFO] Installing and starting Monitoring Agent service...
[2025-09-19 06:27:29] [DEBUG] Service install result: 2025/09/19 06:27:29 wazuh-agent: INFO: Found (WazuhSvc) service is not running. System.Management.Automation.RemoteException 2025/09/19 06:27:29 wazuh-agent: INFO: Successfully removed (WazuhSvc) from the service database. System.Management.Automation.RemoteException 2025/09/19 06:27:29 wazuh-agent: INFO: Successfully added to the service database. System.Management.Automation.RemoteException
[2025-09-19 06:27:34] [WARN] Service installation attempted but not running, trying process method
[2025-09-19 06:27:34] [INFO] Starting Monitoring Agent as process...
[2025-09-19 06:27:37] [WARN] Process started but exited immediately
[2025-09-19 06:27:37] [DEBUG] Recent log entries: [2025-09-19 06:27:29] [INFO] Installing and starting Monitoring Agent service...; [2025-09-19 06:27:29] [DEBUG] Service install result: 2025/09/19 06:27:29 wazuh-agent: INFO: Found (WazuhSvc) service is not running. System.Management.Automation.RemoteException 2025/09/19 06:27:29 wazuh-agent: INFO: Successfully removed (WazuhSvc) from the service database. System.Management.Automation.RemoteException 2025/09/19 06:27:29 wazuh-agent: INFO: Successfully added to the service database. System.Management.Automation.RemoteException; [2025-09-19 06:27:34] [WARN] Service installation attempted but not running, trying process method; [2025-09-19 06:27:34] [INFO] Starting Monitoring Agent as process...; [2025-09-19 06:27:37] [WARN] Process started but exited immediately
[2025-09-19 06:27:37] [INFO] Trying service method as fallback...
[2025-09-19 06:27:37] [INFO] Starting Monitoring Agent service...
[2025-09-19 06:27:42] [WARN] Service attempt 1/5 - Status: Stopped
[2025-09-19 06:27:43] [INFO] Retrying service start...
[2025-09-19 06:27:46] [WARN] Service attempt 2/5 - Status: StopPending
[2025-09-19 06:27:46] [INFO] Retrying service start...
[2025-09-19 06:27:51] [WARN] Service attempt 3/5 - Status: StopPending
[2025-09-19 06:27:51] [INFO] Retrying service start...
[2025-09-19 06:27:56] [WARN] Service attempt 4/5 - Status: Stopped
[2025-09-19 06:27:56] [INFO] Retrying service start...
[2025-09-19 06:27:59] [WARN] Service attempt 5/5 - Status: StopPending
[2025-09-19 06:27:59] [ERROR] Failed to start Monitoring Agent service after 5 attempts
[2025-09-19 06:27:59] [INFO] Attempting alternative process start method...
[2025-09-19 06:28:02] [INFO] ✓ Started agent as process with PID: 1356
[2025-09-19 06:28:34] [INFO] Production validation passed
[2025-09-19 06:28:34] [INFO] Stopping Monitoring Agent v4.8.0 and Fault Tolerance...
[2025-09-19 06:28:34] [INFO] Windows services not available on this platform
[2025-09-19 06:28:34] [INFO] Forcing agent disconnection from Wazuh manager...
[2025-09-19 06:28:34] [INFO] Agent ID: 001 - temporarily disabling connection
[2025-09-19 06:28:34] [INFO] Agent authentication disabled - will appear as disconnected
[2025-09-19 06:28:36] [DEBUG] Stopping fault tolerance components for Windows...
[2025-09-19 06:28:39] [INFO] MONITORING_AGENT not running...
[2025-09-19 06:28:39] [INFO] monitoring-agentd not running...
[2025-09-19 06:28:39] [INFO] Monitoring Agent v4.8.0 Stopped
[2025-09-19 06:29:35] [INFO] Production validation passed
[2025-09-19 06:29:35] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 06:29:35] [DEBUG] Validating configuration...
[2025-09-19 06:29:35] [DEBUG] Configuration validation passed
[2025-09-19 06:29:35] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 06:29:35] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 06:29:35] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 06:29:35] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 06:29:35] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 06:29:36] [INFO] Environment setup completed
[2025-09-19 06:29:36] [DEBUG] Checking for disabled agent connection...
[2025-09-19 06:29:36] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 06:29:36] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 06:29:36] [DEBUG] Signal handlers configured for Windows
[2025-09-19 06:29:36] [DEBUG] State tracking initialized
[2025-09-19 06:29:36] [INFO] Starting monitoring-agentd...
[2025-09-19 06:29:36] [DEBUG] Setting up Windows agent environment...
[2025-09-19 06:29:36] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 06:29:36] [DEBUG] Copied client.keys to bin directory
[2025-09-19 06:29:36] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 06:29:36] [DEBUG] Copied local_internal_options.conf to bin directory
[2025-09-19 06:29:36] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 06:29:36] [DEBUG] Copied bypass.dll to bin directory
[2025-09-19 06:29:36] [DEBUG] Copied dbsync.dll to bin directory
[2025-09-19 06:29:36] [DEBUG] Copied fimdb.dll to bin directory
[2025-09-19 06:29:36] [DEBUG] Copied LIBGCC_S_DW2_1.DLL to bin directory
[2025-09-19 06:29:36] [DEBUG] Copied LIBSTDCPP_6.DLL to bin directory
[2025-09-19 06:29:36] [DEBUG] Copied libwazuhext.dll to bin directory
[2025-09-19 06:29:36] [DEBUG] Copied libwazuhshared.dll to bin directory
[2025-09-19 06:29:36] [DEBUG] Copied LIBWINPTHREAD_1.DLL to bin directory
[2025-09-19 06:29:36] [DEBUG] Copied rsync.dll to bin directory
[2025-09-19 06:29:36] [DEBUG] Copied syscollector.dll to bin directory
[2025-09-19 06:29:36] [DEBUG] Copied sysinfo.dll to bin directory
[2025-09-19 06:29:36] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 06:29:36] [DEBUG] Copied OSSEC.CONF to bin directory
[2025-09-19 06:29:36] [DEBUG] Copied client.keys to bin directory
[2025-09-19 06:29:36] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 06:29:36] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 06:29:36] [INFO] Installing and starting Monitoring Agent service...
[2025-09-19 06:29:36] [DEBUG] Service install result: 2025/09/19 06:29:36 wazuh-agent: INFO: Found (WazuhSvc) service is not running. System.Management.Automation.RemoteException 2025/09/19 06:29:36 wazuh-agent: INFO: Successfully removed (WazuhSvc) from the service database. System.Management.Automation.RemoteException 2025/09/19 06:29:36 wazuh-agent: INFO: Successfully added to the service database. System.Management.Automation.RemoteException
[2025-09-19 06:29:41] [WARN] Service installation attempted but not running, trying process method
[2025-09-19 06:29:41] [INFO] Starting Monitoring Agent as process...
[2025-09-19 06:29:44] [WARN] Process started but exited immediately
[2025-09-19 06:29:44] [DEBUG] Recent log entries: [2025-09-19 06:29:36] [INFO] Installing and starting Monitoring Agent service...; [2025-09-19 06:29:36] [DEBUG] Service install result: 2025/09/19 06:29:36 wazuh-agent: INFO: Found (WazuhSvc) service is not running. System.Management.Automation.RemoteException 2025/09/19 06:29:36 wazuh-agent: INFO: Successfully removed (WazuhSvc) from the service database. System.Management.Automation.RemoteException 2025/09/19 06:29:36 wazuh-agent: INFO: Successfully added to the service database. System.Management.Automation.RemoteException; [2025-09-19 06:29:41] [WARN] Service installation attempted but not running, trying process method; [2025-09-19 06:29:41] [INFO] Starting Monitoring Agent as process...; [2025-09-19 06:29:44] [WARN] Process started but exited immediately
[2025-09-19 06:29:44] [INFO] Trying service method as fallback...
[2025-09-19 06:29:44] [INFO] Starting Monitoring Agent service...
[2025-09-19 06:29:49] [WARN] Service attempt 1/5 - Status: Stopped
[2025-09-19 06:29:49] [INFO] Retrying service start...
[2025-09-19 06:29:52] [WARN] Service attempt 2/5 - Status: StopPending
[2025-09-19 06:29:52] [INFO] Retrying service start...
[2025-09-19 06:29:57] [WARN] Service attempt 3/5 - Status: StopPending
[2025-09-19 06:29:57] [INFO] Retrying service start...
[2025-09-19 06:30:02] [WARN] Service attempt 4/5 - Status: Stopped
[2025-09-19 06:30:02] [INFO] Retrying service start...
[2025-09-19 06:30:06] [WARN] Service attempt 5/5 - Status: StopPending
[2025-09-19 06:30:06] [ERROR] Failed to start Monitoring Agent service after 5 attempts
[2025-09-19 06:30:06] [INFO] Attempting alternative process start method...
[2025-09-19 06:30:09] [INFO] ✓ Started agent as process with PID: 20940
[2025-09-19 06:30:24] [INFO] Production validation passed
[2025-09-19 06:30:24] [INFO] Stopping Monitoring Agent v4.8.0 and Fault Tolerance...
[2025-09-19 06:30:24] [INFO] Windows services not available on this platform
[2025-09-19 06:30:24] [INFO] Forcing agent disconnection from Wazuh manager...
[2025-09-19 06:30:24] [INFO] Agent ID: 001 - temporarily disabling connection
[2025-09-19 06:30:24] [INFO] Agent authentication disabled - will appear as disconnected
[2025-09-19 06:30:24] [DEBUG] Sending disconnect signal to manager...
[2025-09-19 06:30:30] [DEBUG] Stopping fault tolerance components for Windows...
[2025-09-19 06:30:33] [INFO] MONITORING_AGENT not running...
[2025-09-19 06:30:33] [INFO] monitoring-agentd not running...
[2025-09-19 06:30:33] [INFO] Monitoring Agent v4.8.0 Stopped
[2025-09-19 06:31:05] [INFO] Production validation passed
[2025-09-19 06:31:14] [INFO] Production validation passed
[2025-09-19 06:31:14] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 06:31:14] [DEBUG] Validating configuration...
[2025-09-19 06:31:14] [DEBUG] Configuration validation passed
[2025-09-19 06:31:14] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 06:31:14] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 06:31:14] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 06:31:14] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 06:31:14] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 06:31:14] [INFO] Environment setup completed
[2025-09-19 06:31:14] [DEBUG] Checking for disabled agent connection...
[2025-09-19 06:31:14] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 06:31:14] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 06:31:14] [DEBUG] Signal handlers configured for Windows
[2025-09-19 06:31:14] [DEBUG] State tracking initialized
[2025-09-19 06:31:14] [INFO] Starting monitoring-agentd...
[2025-09-19 06:31:14] [DEBUG] Setting up Windows agent environment...
[2025-09-19 06:31:14] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 06:31:14] [DEBUG] Copied client.keys to bin directory
[2025-09-19 06:31:14] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 06:31:14] [DEBUG] Copied local_internal_options.conf to bin directory
[2025-09-19 06:31:14] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 06:31:14] [DEBUG] Copied bypass.dll to bin directory
[2025-09-19 06:31:14] [DEBUG] Copied dbsync.dll to bin directory
[2025-09-19 06:31:15] [DEBUG] Copied fimdb.dll to bin directory
[2025-09-19 06:31:15] [DEBUG] Copied LIBGCC_S_DW2_1.DLL to bin directory
[2025-09-19 06:31:15] [DEBUG] Copied LIBSTDCPP_6.DLL to bin directory
[2025-09-19 06:31:15] [DEBUG] Copied libwazuhext.dll to bin directory
[2025-09-19 06:31:15] [DEBUG] Copied libwazuhshared.dll to bin directory
[2025-09-19 06:31:15] [DEBUG] Copied LIBWINPTHREAD_1.DLL to bin directory
[2025-09-19 06:31:15] [DEBUG] Copied rsync.dll to bin directory
[2025-09-19 06:31:15] [DEBUG] Copied syscollector.dll to bin directory
[2025-09-19 06:31:15] [DEBUG] Copied sysinfo.dll to bin directory
[2025-09-19 06:31:15] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 06:31:15] [DEBUG] Copied OSSEC.CONF to bin directory
[2025-09-19 06:31:15] [DEBUG] Copied client.keys to bin directory
[2025-09-19 06:31:15] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 06:31:15] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 06:31:15] [INFO] Installing and starting Monitoring Agent service...
[2025-09-19 06:31:15] [DEBUG] Service install result: 2025/09/19 06:31:15 wazuh-agent: INFO: Found (WazuhSvc) service is not running. System.Management.Automation.RemoteException 2025/09/19 06:31:15 wazuh-agent: INFO: Successfully removed (WazuhSvc) from the service database. System.Management.Automation.RemoteException 2025/09/19 06:31:15 wazuh-agent: INFO: Successfully added to the service database. System.Management.Automation.RemoteException
[2025-09-19 06:31:20] [WARN] Service installation attempted but not running, trying process method
[2025-09-19 06:31:20] [INFO] Starting Monitoring Agent as process...
[2025-09-19 06:31:23] [WARN] Process started but exited immediately
[2025-09-19 06:31:23] [DEBUG] Recent log entries: [2025-09-19 06:31:15] [INFO] Installing and starting Monitoring Agent service...; [2025-09-19 06:31:15] [DEBUG] Service install result: 2025/09/19 06:31:15 wazuh-agent: INFO: Found (WazuhSvc) service is not running. System.Management.Automation.RemoteException 2025/09/19 06:31:15 wazuh-agent: INFO: Successfully removed (WazuhSvc) from the service database. System.Management.Automation.RemoteException 2025/09/19 06:31:15 wazuh-agent: INFO: Successfully added to the service database. System.Management.Automation.RemoteException; [2025-09-19 06:31:20] [WARN] Service installation attempted but not running, trying process method; [2025-09-19 06:31:20] [INFO] Starting Monitoring Agent as process...; [2025-09-19 06:31:23] [WARN] Process started but exited immediately
[2025-09-19 06:31:23] [INFO] Trying service method as fallback...
[2025-09-19 06:31:23] [INFO] Starting Monitoring Agent service...
[2025-09-19 06:31:28] [WARN] Service attempt 1/5 - Status: StopPending
[2025-09-19 06:31:28] [INFO] Retrying service start...
[2025-09-19 06:31:31] [WARN] Service attempt 2/5 - Status: StopPending
[2025-09-19 06:31:31] [INFO] Retrying service start...
[2025-09-19 06:31:36] [WARN] Service attempt 3/5 - Status: StopPending
[2025-09-19 06:31:36] [INFO] Retrying service start...
[2025-09-19 06:31:41] [WARN] Service attempt 4/5 - Status: Stopped
[2025-09-19 06:31:41] [INFO] Retrying service start...
[2025-09-19 06:31:45] [WARN] Service attempt 5/5 - Status: StopPending
[2025-09-19 06:31:45] [ERROR] Failed to start Monitoring Agent service after 5 attempts
[2025-09-19 06:31:45] [INFO] Attempting alternative process start method...
[2025-09-19 06:31:48] [INFO] ✓ Started agent as process with PID: 10292
[2025-09-19 06:32:05] [INFO] Production validation passed
[2025-09-19 06:32:05] [INFO] Stopping Monitoring Agent v4.8.0 and Fault Tolerance...
[2025-09-19 06:32:05] [INFO] Windows services not available on this platform
[2025-09-19 06:32:05] [INFO] Forcing agent disconnection from Wazuh manager...
[2025-09-19 06:32:05] [INFO] Agent ID: 001 - temporarily disabling connection
[2025-09-19 06:32:05] [INFO] Agent authentication disabled - will appear as disconnected
[2025-09-19 06:32:05] [DEBUG] Sending disconnect signal to manager...
[2025-09-19 06:32:10] [DEBUG] Stopping fault tolerance components for Windows...
[2025-09-19 06:32:13] [INFO] MONITORING_AGENT not running...
[2025-09-19 06:32:13] [INFO] monitoring-agentd not running...
[2025-09-19 06:32:13] [INFO] Monitoring Agent v4.8.0 Stopped
[2025-09-19 06:32:31] [INFO] Production validation passed
[2025-09-19 06:33:38] [INFO] Production validation passed
[2025-09-19 06:33:38] [INFO] Starting agent as current user: DESKTOP-IVBQT1T\ANANDHU
[2025-09-19 06:33:38] [DEBUG] Validating configuration...
[2025-09-19 06:33:38] [DEBUG] Configuration validation passed
[2025-09-19 06:33:38] [INFO] Starting Monitoring Agent v4.8.0 with Fault Tolerance...
[2025-09-19 06:33:38] [DEBUG] Initializing Windows monitoring bypass system...
[2025-09-19 06:33:38] [INFO] Windows bypass DLL found: C:\Users\ANANDHU\OneDrive\Desktop\monitoring-agent\windows\lib\bypass.dll
[2025-09-19 06:33:38] [INFO] ✓ Bypass DLL loaded successfully
[2025-09-19 06:33:38] [INFO] Ensuring proper environment for Monitoring Agent...
[2025-09-19 06:33:38] [INFO] Environment setup completed
[2025-09-19 06:33:38] [DEBUG] Checking for disabled agent connection...
[2025-09-19 06:33:38] [DEBUG] Initializing fault tolerance components for Windows...
[2025-09-19 06:33:38] [DEBUG] Watchdog script not found, skipping process monitoring
[2025-09-19 06:33:38] [DEBUG] Signal handlers configured for Windows
[2025-09-19 06:33:38] [DEBUG] State tracking initialized
[2025-09-19 06:33:38] [INFO] Starting monitoring-agentd...
[2025-09-19 06:33:38] [DEBUG] Setting up Windows agent environment...
[2025-09-19 06:33:38] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 06:33:38] [DEBUG] Copied client.keys to bin directory
[2025-09-19 06:33:38] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 06:33:38] [DEBUG] Copied local_internal_options.conf to bin directory
[2025-09-19 06:33:38] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 06:33:38] [DEBUG] Copied bypass.dll to bin directory
[2025-09-19 06:33:38] [DEBUG] Copied dbsync.dll to bin directory
[2025-09-19 06:33:38] [DEBUG] Copied fimdb.dll to bin directory
[2025-09-19 06:33:38] [DEBUG] Copied LIBGCC_S_DW2_1.DLL to bin directory
[2025-09-19 06:33:38] [DEBUG] Copied LIBSTDCPP_6.DLL to bin directory
[2025-09-19 06:33:38] [DEBUG] Copied libwazuhext.dll to bin directory
[2025-09-19 06:33:38] [DEBUG] Copied libwazuhshared.dll to bin directory
[2025-09-19 06:33:38] [DEBUG] Copied LIBWINPTHREAD_1.DLL to bin directory
[2025-09-19 06:33:38] [DEBUG] Copied rsync.dll to bin directory
[2025-09-19 06:33:38] [DEBUG] Copied syscollector.dll to bin directory
[2025-09-19 06:33:38] [DEBUG] Copied sysinfo.dll to bin directory
[2025-09-19 06:33:38] [DEBUG] Copied ossec.conf to bin directory
[2025-09-19 06:33:38] [DEBUG] Copied OSSEC.CONF to bin directory
[2025-09-19 06:33:38] [DEBUG] Copied client.keys to bin directory
[2025-09-19 06:33:38] [DEBUG] Copied internal_options.conf to bin directory
[2025-09-19 06:33:38] [DEBUG] Copied wpk_root.pem to bin directory
[2025-09-19 06:33:38] [INFO] Installing and starting Monitoring Agent service...
[2025-09-19 06:33:38] [DEBUG] Service install result: 2025/09/19 06:33:38 wazuh-agent: INFO: Found (WazuhSvc) service is not running. System.Management.Automation.RemoteException 2025/09/19 06:33:38 wazuh-agent: INFO: Successfully removed (WazuhSvc) from the service database. System.Management.Automation.RemoteException 2025/09/19 06:33:38 wazuh-agent: INFO: Successfully added to the service database. System.Management.Automation.RemoteException
[2025-09-19 06:33:43] [WARN] Service installation attempted but not running, trying process method
[2025-09-19 06:33:43] [INFO] Starting Monitoring Agent as process...
[2025-09-19 06:33:47] [WARN] Process started but exited immediately
[2025-09-19 06:33:47] [DEBUG] Recent log entries: [2025-09-19 06:33:38] [INFO] Installing and starting Monitoring Agent service...; [2025-09-19 06:33:38] [DEBUG] Service install result: 2025/09/19 06:33:38 wazuh-agent: INFO: Found (WazuhSvc) service is not running. System.Management.Automation.RemoteException 2025/09/19 06:33:38 wazuh-agent: INFO: Successfully removed (WazuhSvc) from the service database. System.Management.Automation.RemoteException 2025/09/19 06:33:38 wazuh-agent: INFO: Successfully added to the service database. System.Management.Automation.RemoteException; [2025-09-19 06:33:43] [WARN] Service installation attempted but not running, trying process method; [2025-09-19 06:33:43] [INFO] Starting Monitoring Agent as process...; [2025-09-19 06:33:47] [WARN] Process started but exited immediately
[2025-09-19 06:33:47] [INFO] Trying service method as fallback...
[2025-09-19 06:33:47] [INFO] Starting Monitoring Agent service...
[2025-09-19 06:33:52] [WARN] Service attempt 1/5 - Status: StopPending
[2025-09-19 06:33:52] [INFO] Retrying service start...
[2025-09-19 06:33:57] [WARN] Service attempt 2/5 - Status: Stopped
[2025-09-19 06:33:57] [INFO] Retrying service start...
[2025-09-19 06:34:00] [WARN] Service attempt 3/5 - Status: StopPending
[2025-09-19 06:34:00] [INFO] Retrying service start...
[2025-09-19 06:34:05] [WARN] Service attempt 4/5 - Status: StopPending
[2025-09-19 06:34:05] [INFO] Retrying service start...
[2025-09-19 06:34:10] [WARN] Service attempt 5/5 - Status: Stopped
[2025-09-19 06:34:10] [ERROR] Failed to start Monitoring Agent service after 5 attempts
[2025-09-19 06:34:10] [INFO] Attempting alternative process start method...
[2025-09-19 06:34:33] [INFO] Production validation passed
