<!--
  Monitoring Agent - Minimal configuration for Windows (No File/Registry Monitoring)
  Professional security monitoring platform
  Copyright (C) 2025, Monitoring Solutions Inc.
-->

<ossec_config>

  <client>
    <server>
      <address>localhost</address>
      <port>1514</port>
      <protocol>tcp</protocol>
    </server>
    <crypto_method>aes</crypto_method>
    <notify_time>60</notify_time>
    <time-reconnect>30</time-reconnect>
    <auto_restart>yes</auto_restart>
  </client>

  <!-- Agent buffer options -->
  <client_buffer>
    <disabled>no</disabled>
    <queue_size>5000</queue_size>
    <events_per_second>500</events_per_second>
  </client_buffer>

  <!-- Log analysis only - no file monitoring -->
  <localfile>
    <location>Application</location>
    <log_format>eventchannel</log_format>
  </localfile>

  <localfile>
    <location>Security</location>
    <log_format>eventchannel</log_format>
    <query>Event/System[EventID != 5145 and EventID != 5156 and EventID != 5447 and
      EventID != 4656 and EventID != 4658 and EventID != 4663 and EventID != 4660 and
      EventID != 4670 and EventID != 4690 and EventID != 4703 and EventID != 4907 and
      EventID != 5152 and EventID != 5157]</query>
  </localfile>

  <localfile>
    <location>System</location>
    <log_format>eventchannel</log_format>
  </localfile>

  <!-- Disable all monitoring components -->
  <rootcheck>
    <disabled>yes</disabled>
  </rootcheck>

  <syscheck>
    <disabled>yes</disabled>
  </syscheck>

  <sca>
    <enabled>no</enabled>
  </sca>

  <!-- Disable potentially problematic modules -->
  <wodle name="cis-cat">
    <disabled>yes</disabled>
  </wodle>

  <wodle name="osquery">
    <disabled>yes</disabled>
  </wodle>

  <!-- Active response disabled -->
  <active-response>
    <disabled>yes</disabled>
  </active-response>

  <!-- Choose between plain or json format (or both) for internal logs -->
  <logging>
    <log_format>plain</log_format>
  </logging>

</ossec_config>

<!-- END of Minimal Configuration. -->